<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Takes a data.frame and creates a barplot"><title>Make a barplot — create.barplot • BoutrosLab.plotting.general</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a barplot — create.barplot"><meta property="og:description" content="Takes a data.frame and creates a barplot"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BoutrosLab.plotting.general</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">7.0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/uclahs-cds/public-R-BoutrosLab-plotting-general/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Make a barplot</h1>
      
      <div class="d-none name"><code>create.barplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a data.frame and creates a barplot</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create.barplot</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stack <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  main.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.cex <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'~'</span>, <span class="st">''</span>, <span class="va">formula</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'~'</span>, <span class="st">''</span>, <span class="va">formula</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ylab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  ylab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlab.top.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab.top.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab.top.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlab.top.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  xlab.top.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  xlab.top.y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  abline.h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  abline.lwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  axes.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xgrid.at <span class="op">=</span> <span class="va">xat</span>,</span>
<span>  ygrid.at <span class="op">=</span> <span class="va">yat</span>,</span>
<span>  grid.lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  grid.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.lab <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  yaxis.lab <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  yaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  yaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  xaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  yaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xaxis.tck <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  yaxis.tck <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  yat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as.table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  x.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  y.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  x.relation <span class="op">=</span> <span class="st">'same'</span>,</span>
<span>  y.relation <span class="op">=</span> <span class="st">'same'</span>,</span>
<span>  top.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  bottom.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  right.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  left.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  key.bottom <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  ylab.axis.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  xlab.axis.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  border.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  border.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot.horizontal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  background.col <span class="op">=</span> <span class="st">'transparent'</span>,</span>
<span>  origin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  box.ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sample.order <span class="op">=</span> <span class="st">'none'</span>,</span>
<span>  group.labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add.text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  text.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  strip.col <span class="op">=</span> <span class="st">'white'</span>,</span>
<span>  strip.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  y.error.up <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.error.down <span class="op">=</span> <span class="va">y.error.up</span>,</span>
<span>  y.error.bar.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  error.whisker.width <span class="op">=</span> <span class="va">width</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  error.bar.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  error.whisker.angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  add.rectangle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xleft.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ybottom.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xright.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ytop.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.rectangle <span class="op">=</span> <span class="st">'grey85'</span>,</span>
<span>  alpha.rectangle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  line.func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line.from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  line.to <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  line.col <span class="op">=</span> <span class="st">'transparent'</span>,</span>
<span>  line.infront <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  text.above.bars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    padding <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    bar.locations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    rotation <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span>,</span>
<span>  raster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  raster.vert <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  raster.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  raster.width.dim <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="fl">37</span>, <span class="st">'npc'</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  size.units <span class="op">=</span> <span class="st">'in'</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1600</span>,</span>
<span>  enable.warnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  description <span class="op">=</span> <span class="st">'Created with BoutrosLab.plotting.general'</span>,</span>
<span>  style <span class="op">=</span> <span class="st">'BoutrosLab'</span>,</span>
<span>  preload.default <span class="op">=</span> <span class="st">'custom'</span>,</span>
<span>  use.legacy.settings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inside.legend.auto <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  disable.factor.sorting <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>;</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>The formula used to extract the x &amp; y components from the data-frame</p></dd>

    <dt>data</dt>
<dd><p>The data-frame to plot</p></dd>

    <dt>groups</dt>
<dd><p>Optional grouping variable.  Expression or variable.</p></dd>

    <dt>stack</dt>
<dd><p>Logical, relevant when groups is non-null. If FALSE (the default), bars for different values of the grouping variable are drawn side by side, otherwise they are stacked</p></dd>

    <dt>filename</dt>
<dd><p>Filename for tiff output, or if NULL returns the trellis object itself</p></dd>

    <dt>main</dt>
<dd><p>The main title for the plot (space is reclaimed if NULL)</p></dd>

    <dt>main.just</dt>
<dd><p>The justification of the main title for the plot, default is centered</p></dd>

    <dt>main.x</dt>
<dd><p>The x location of the main title, deault is 0.5</p></dd>

    <dt>main.y</dt>
<dd><p>The y location of the main title, default is 0.5</p></dd>

    <dt>main.cex</dt>
<dd><p>Size of text for main plot title, defaults to 3</p></dd>

    <dt>xlab.label</dt>
<dd><p>The label for the x-axis</p></dd>

    <dt>ylab.label</dt>
<dd><p>The label for the y-axis</p></dd>

    <dt>xlab.cex</dt>
<dd><p>Size of x-axis label, defaults to 2</p></dd>

    <dt>ylab.cex</dt>
<dd><p>Size of y-axis label, defaults to 2</p></dd>

    <dt>xlab.col</dt>
<dd><p>Colour of the x-axis label, defaults to black</p></dd>

    <dt>ylab.col</dt>
<dd><p>Colour of the y-axis label, defaults to black</p></dd>

    <dt>xlab.top.label</dt>
<dd><p>The label for the top x-axis</p></dd>

    <dt>xlab.top.cex</dt>
<dd><p>Size of top x-axis label</p></dd>

    <dt>xlab.top.col</dt>
<dd><p>Colour of the top x-axis label</p></dd>

    <dt>xlab.top.just</dt>
<dd><p>Justification of the top x-axis label, defaults to centered</p></dd>

    <dt>xlab.top.x</dt>
<dd><p>The x location of the top x-axis label</p></dd>

    <dt>xlab.top.y</dt>
<dd><p>The y location of the top y-axis label</p></dd>

    <dt>abline.h</dt>
<dd><p>Specify the superimposed horizontal line(s)</p></dd>

    <dt>abline.v</dt>
<dd><p>Specify the superimposed vertical line(s)</p></dd>

    <dt>abline.lty</dt>
<dd><p>Specify the superimposed line type</p></dd>

    <dt>abline.lwd</dt>
<dd><p>Specify the superimposed line width</p></dd>

    <dt>abline.col</dt>
<dd><p>Specify the superimposed line colour (defaults to black)</p></dd>

    <dt>axes.lwd</dt>
<dd><p>Specify line width of the axes; set to 0 to turn off axes</p></dd>

    <dt>add.grid</dt>
<dd><p>Specify whether to draw grid or not (defaults to FALSE)</p></dd>

    <dt>xgrid.at</dt>
<dd><p>Specify where to draw x-axis grid lines (defaults to xat)</p></dd>

    <dt>ygrid.at</dt>
<dd><p>Specify where to draw y-axis grid lines (defaults to yat)</p></dd>

    <dt>grid.lwd</dt>
<dd><p>Specify width of grid line (defaults to 5)</p></dd>

    <dt>grid.col</dt>
<dd><p>Specify colour of grid line. Currently only supports one colour. Defaults to NULL, which uses the colour of the reference line.</p></dd>

    <dt>xaxis.lab</dt>
<dd><p>Vector listing x-axis tick labels, defaults to automatic</p></dd>

    <dt>yaxis.lab</dt>
<dd><p>Vector listing y-axis tick labels, defaults to automatic</p></dd>

    <dt>xaxis.col</dt>
<dd><p>Colour of the x-axis tick labels, defaults to black</p></dd>

    <dt>yaxis.col</dt>
<dd><p>Colour of the y-axis tick labels, defaults to black</p></dd>

    <dt>xaxis.fontface</dt>
<dd><p>Fontface for the x-axis scales</p></dd>

    <dt>yaxis.fontface</dt>
<dd><p>Fontface for the y-axis scales</p></dd>

    <dt>xaxis.cex</dt>
<dd><p>Size of x-axis tick labels, defaults to 1.2</p></dd>

    <dt>yaxis.cex</dt>
<dd><p>Size of y-axis tick labels, defaults to 1.5</p></dd>

    <dt>xaxis.rot</dt>
<dd><p>Rotation of x-axis tick labels; defaults to 0</p></dd>

    <dt>yaxis.rot</dt>
<dd><p>Rotation of y-axis tick labels; defaults to 0</p></dd>

    <dt>xaxis.tck</dt>
<dd><p>Specifies the length of the tick marks for x-axis, defaults to 1</p></dd>

    <dt>yaxis.tck</dt>
<dd><p>Specifies the length of the tick marks for y-axis, defaults to 1</p></dd>

    <dt>xlimits</dt>
<dd><p>Two-element vector giving the x-axis limits. Useful when plot.horizontal = TRUE</p></dd>

    <dt>ylimits</dt>
<dd><p>Two-element vector giving the y-axis limits</p></dd>

    <dt>xat</dt>
<dd><p>Vector listing where the x-axis labels should be drawn. Useful when plot.horizontal = TRUE</p></dd>

    <dt>yat</dt>
<dd><p>Vector listing where the y-axis labels should be drawn</p></dd>

    <dt>layout</dt>
<dd><p>A vector specifying the number of columns, rows (e.g., c(2,1). Default is NULL; see lattice::xyplot for more details</p></dd>
</dl><p>.</p>
<dl><dt>as.table</dt>
<dd><p>Specifies panel drawing order, default is FALSE which draws panels from bottom left corner, moving right then up. Set to TRUE to draw from top left corner, moving right then down</p></dd>

    <dt>x.spacing</dt>
<dd><p>A number specifying the distance between panels along the x-axis, defaults to 0</p></dd>

    <dt>y.spacing</dt>
<dd><p>A number specifying the distance between panels along the y-axis, defaults to 0</p></dd>

    <dt>x.relation</dt>
<dd><p>Allows x-axis scales to vary if set to “free”, defaults to “same”</p></dd>

    <dt>y.relation</dt>
<dd><p>Allows y-axis scales to vary if set to “free”, defaults to “same”</p></dd>

    <dt>top.padding</dt>
<dd><p>A number specifying the distance to the top margin, defaults to 0.5</p></dd>

    <dt>bottom.padding</dt>
<dd><p>A number specifying the distance to the bottom margin, defaults to 2</p></dd>

    <dt>right.padding</dt>
<dd><p>A number specifying the distance to the right margin, defaults to 1</p></dd>

    <dt>left.padding</dt>
<dd><p>A number specifying the distance to the left margin, defaults to 1</p></dd>

    <dt>key.bottom</dt>
<dd><p>A number specifying how much space should be left for the key at the bottom, defaults to 0.1</p></dd>

    <dt>ylab.axis.padding</dt>
<dd><p>A number specifying the distance of y-axis label to the y-axis, defaults to 0</p></dd>
</dl><p>,</p>
<dl><dt>xlab.axis.padding</dt>
<dd><p>A number specifying the distance of x-axis label to the x-axis, defaults to 0.5. Named differently than ylab.axis.padding because these are lattice's internal names for these values</p></dd>

    <dt>col</dt>
<dd><p>Filling colour of bars, defaults to black, does a grey-scale spectrum if !is.null(groups)</p></dd>

    <dt>border.col</dt>
<dd><p>Specify border colour (defaults to black)</p></dd>

    <dt>border.lwd</dt>
<dd><p>Specify border width (defaults to 1)</p></dd>

    <dt>plot.horizontal</dt>
<dd><p>Plot the bars horizontally</p></dd>

    <dt>background.col</dt>
<dd><p>Plot background colour, defaults to transparent</p></dd>

    <dt>origin</dt>
<dd><p>The origin of the plot, generally 0</p></dd>

    <dt>reference</dt>
<dd><p>Should the reference line be printed at the origin</p></dd>

    <dt>box.ratio</dt>
<dd><p>Specifies the width of each bar, defaults to 2</p></dd>

    <dt>sample.order</dt>
<dd><p>Should the bars be reordered, accepts values “increasing”, “decreasing” or a vector of sample names. Labels will also be reordered</p></dd>

    <dt>group.labels</dt>
<dd><p>Should the labels be grouped to the same amount of bars per column</p></dd>

    <dt>key</dt>
<dd><p>A list giving the key (legend). The default suppresses drawing</p></dd>

    <dt>legend</dt>
<dd><p>Add a legend to the plot.  Helpful for adding multiple keys and adding keys to the margins of the plot. See xyplot.</p></dd>

    <dt>add.text</dt>
<dd><p>Allow additional text to be drawn, default is FALSE</p></dd>

    <dt>text.labels</dt>
<dd><p>Labels for additional text</p></dd>

    <dt>text.x</dt>
<dd><p>The x co-ordinates where additional text should be placed</p></dd>

    <dt>text.y</dt>
<dd><p>The y co-ordinates where additional text should be placed</p></dd>

    <dt>text.col</dt>
<dd><p>The colour of additional text</p></dd>

    <dt>text.cex</dt>
<dd><p>The size of additional text</p></dd>

    <dt>text.fontface</dt>
<dd><p>The fontface for additional text</p></dd>

    <dt>strip.col</dt>
<dd><p>Strip background colour, defaults to white</p></dd>

    <dt>strip.cex</dt>
<dd><p>Strip title character expansion</p></dd>

    <dt>y.error.up</dt>
<dd><p>A vector specifying the length of the error bar going up from each point. If set to NULL (the default), error bars will not be drawn</p></dd>

    <dt>y.error.down</dt>
<dd><p>A vector specifying the length of the error bar going down from each point. By default, it is set to y.error.up</p></dd>

    <dt>y.error.bar.col</dt>
<dd><p>A string or vector of strings specifying the colour of the error bars. Defaults to black</p></dd>

    <dt>error.whisker.width</dt>
<dd><p>A number specifying the width of the error bars. Defaults to a rough approximation based on the size of the data</p></dd>

    <dt>error.bar.lwd</dt>
<dd><p>The line width of the error bars. Defaults to 1</p></dd>

    <dt>error.whisker.angle</dt>
<dd><p>The angle of the error bar whiskers, defaults to 90. Can be changed to produce arrow-like bars</p></dd>

    <dt>add.rectangle</dt>
<dd><p>Allow a rectangle to be drawn, default is FALSE</p></dd>

    <dt>xleft.rectangle</dt>
<dd><p>Specifies the left x coordinate of the rectangle to be drawn</p></dd>

    <dt>ybottom.rectangle</dt>
<dd><p>Specifies the bottom y coordinate of the rectangle to be drawn</p></dd>

    <dt>xright.rectangle</dt>
<dd><p>Specifies the right x coordinate of the rectangle to be drawn</p></dd>

    <dt>ytop.rectangle</dt>
<dd><p>Specifies the top y coordinate of the rectangle to be drawn</p></dd>

    <dt>col.rectangle</dt>
<dd><p>Specifies the colour to fill the rectangle's area</p></dd>

    <dt>alpha.rectangle</dt>
<dd><p>Specifies the colour bias of the rectangle</p></dd>

    <dt>line.func</dt>
<dd><p>Function for the line that should be drawn on top of plot</p></dd>

    <dt>line.from</dt>
<dd><p>The starting point of the line on the plot</p></dd>

    <dt>line.to</dt>
<dd><p>The ending point of the line on the plot</p></dd>

    <dt>line.col</dt>
<dd><p>Colour of the line on the plot</p></dd>

    <dt>line.infront</dt>
<dd><p>Should the line appear in front of the plot or not</p></dd>

    <dt>text.above.bars</dt>
<dd><p>Should some form of text appear above the bars; input as a list</p></dd>

    <dt>raster</dt>
<dd><p>The image to raster over each bar - see Raster Images in R Graphics by Paul Murrell for full details</p></dd>

    <dt>raster.vert</dt>
<dd><p>A logical indicating whether the raster is applied vertically or horizontally</p></dd>

    <dt>raster.just</dt>
<dd><p>A word giving the justification of the raster, can be set to “left”, “right”, “centre”, “center”, “bottom”, or “top”</p></dd>

    <dt>raster.width.dim</dt>
<dd><p>A unit object giving the width of the raster bar</p></dd>

    <dt>height</dt>
<dd><p>Figure height, defaults to 6 in</p></dd>

    <dt>width</dt>
<dd><p>Figure width, defaults to 6 in</p></dd>

    <dt>size.units</dt>
<dd><p>Figure units, defaults to inches</p></dd>

    <dt>resolution</dt>
<dd><p>Figure resolution, defaults to 1600</p></dd>

    <dt>enable.warnings</dt>
<dd><p>Print warnings if set to TRUE, defaults to FALSE</p></dd>

    <dt>description</dt>
<dd><p>Description of image/plot; default NULL</p></dd>

    <dt>style</dt>
<dd><p>defaults to “BoutrosLab”, also accepts “Nature”, which changes parameters according to Nature formatting requirements</p></dd>

    <dt>preload.default</dt>
<dd><p>ability to set multiple sets of diffrent defaults depending on publication needs</p></dd>

    <dt>use.legacy.settings</dt>
<dd><p>boolean to set wheter or not to use legacy mode settings (font)</p></dd>

    <dt>inside.legend.auto</dt>
<dd><p>boolean specifying whether or not to use the automatic inside legend function</p></dd>

    <dt>disable.factor.sorting</dt>
<dd><p>Disable barplot auto sorting factors alphabetically/numerically</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>filename</code> is <code>NULL</code> then returns the trellis object, otherwise creates a plot and returns a 0/1 success code.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mehrdad Shamsi</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>If this function is called without capturing the return value, or specifying a filename, it may crash while trying to draw the histogram. In particular, if a script that uses such a call of create histogram is called by reading the script in from the command line, it will fail badly, with an error message about unavailable fonts:<br></p><div class="sourceCode"><pre><code>
    Error in grid.Call.graphics("L_text", as.graphicsAnnot(x$label), x$x,  )
        Invalid font type
    Calls: print ... drawDetails.text -&gt; grid.Call.graphics -&gt; .Call.graphics
    </code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">barchart</a></code>, <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code> or the Lattice book for an overview of the package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simple.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple example</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Simple', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">30</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-1.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set up the data</span></span></span>
<span class="r-in"><span><span class="va">total.counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">SNV</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="va">mutation.count</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">30</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">count.nonsyn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">mutation.count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">nonsynonymous.SNV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">SNV</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">count.nonsyn</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">other.mutations</span> <span class="op">&lt;-</span> <span class="va">total.counts</span> <span class="op">-</span> <span class="va">nonsynonymous.SNV</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># subset the first fifteen samples</span></span></span>
<span class="r-in"><span><span class="va">barplot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mutation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'nonsynonymous'</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'other'</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nonsynonymous.SNV</span>, <span class="va">other.mutations</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">stage</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    msi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">msi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal input</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Minimal_Input', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span> ,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Minimal input'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Editing the metadata</span></span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-2.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Axes labels &amp; limits</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Custom_Axes', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Axes labels &amp; limits'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Setting axes labels</span></span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Setting y-axis limits and tick-mark locations</span></span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-3.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Font size and font face</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Font_Changes', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Font changes'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing font sizes</span></span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing font type</span></span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-4.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Sorting data</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Sorted', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Sorted bars'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Order bars either by 'increasing' or 'decreasing'</span></span></span>
<span class="r-in"><span>    sample.order <span class="op">=</span> <span class="st">'decreasing'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-5.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sorting data with horizontal barplot</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">samples</span> <span class="op">~</span> <span class="va">values</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Sorted bars'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Order bars either by 'increasing' or 'decreasing'</span></span></span>
<span class="r-in"><span>    sample.order <span class="op">=</span> <span class="st">'decreasing'</span>,</span></span>
<span class="r-in"><span>    plot.horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-plt img"><img src="create.barplot-6.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour changes</span></span></span>
<span class="r-in"><span><span class="va">sex.colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">)</span>,<span class="st">'dodgerblue'</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">sex.colours</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">)</span>, <span class="st">'pink'</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Colour_Changes', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colour changes'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Colour bars based on sex</span></span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-7.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Legend</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Legend', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Legend'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding legend to explain bar colour-coding</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Female'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="co"># Positioning legend on plot</span></span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-8.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouped barplot</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Grouped', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Grouped bar chart'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Setting groups</span></span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="va">mutation</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">12</span>, is.greyscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">12</span>, is.greyscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Nonsynonymous SNV'</span>,<span class="st">'Other SNV'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="fl">0.55</span>,</span></span>
<span class="r-in"><span>            y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-9.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grouped labels</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Grouped_Labels', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Grouped labels'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Setting groups</span></span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="va">mutation</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">12</span>, is.greyscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Grouped labels</span></span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'nonsynonymous'</span>, <span class="st">'other'</span><span class="op">)</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    group.labels <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-10.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stacked barplot</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Stacked', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Stacked bar chart'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="va">mutation</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">12</span>, is.greyscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                        <span class="co"># reverse order to match stacked bar order</span></span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">12</span>, is.greyscale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        <span class="co"># reverse order to match stacked bar order</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Nonsynonymous SNV'</span>,<span class="st">'Other SNV'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="fl">0.55</span>,</span></span>
<span class="r-in"><span>            y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing the plot from a grouped plot to a stacked plot</span></span></span>
<span class="r-in"><span>    stack <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-11.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Panel organization</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Panel_Layout_numeric_conditioning', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    <span class="co"># Setting the panel layout</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span> <span class="op">|</span> <span class="va">type</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Panel layout'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Numeric values detected for conditional variable. If text labels are desired, please convert conditional variable to character.</span>
<span class="r-plt img"><img src="create.barplot-12.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># Setting the panel layout</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span> <span class="op">|</span> <span class="va">mutation</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Panel layout'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-13.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Panel organization 2</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Panel_Layout_2', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span> <span class="op">|</span> <span class="va">mutation</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Panel layout'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the panel layout</span></span></span>
<span class="r-in"><span>    layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y.spacing <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-14.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Covariates</span></span></span>
<span class="r-in"><span><span class="co"># Note: Covariates can also be created using the create.multiplot function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set covariate colour schemes</span></span></span>
<span class="r-in"><span><span class="va">covariate.colours.sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.sex</span><span class="op">[</span><span class="va">covariate.colours.sex</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'dodgerblue'</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.sex</span><span class="op">[</span><span class="va">covariate.colours.sex</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'pink'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">covariate.colours.stage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">stage</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.stage</span><span class="op">[</span><span class="va">covariate.colours.stage</span> <span class="op">==</span> <span class="st">'I'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'plum1'</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.stage</span><span class="op">[</span><span class="va">covariate.colours.stage</span> <span class="op">==</span> <span class="st">'II'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid1'</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.stage</span><span class="op">[</span><span class="va">covariate.colours.stage</span> <span class="op">==</span> <span class="st">'III'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid3'</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.stage</span><span class="op">[</span><span class="va">covariate.colours.stage</span> <span class="op">==</span> <span class="st">'IV'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid4'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">covariate.colours.msi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">msi</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.msi</span><span class="op">[</span><span class="va">covariate.colours.msi</span> <span class="op">==</span> <span class="st">'MSS'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'chartreuse4'</span>;</span></span>
<span class="r-in"><span><span class="va">covariate.colours.msi</span><span class="op">[</span><span class="va">covariate.colours.msi</span> <span class="op">==</span> <span class="st">'MSI-High'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'chartreuse2'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create object to draw covariates</span></span></span>
<span class="r-in"><span><span class="va">covariates.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">covariate.colours.sex</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">covariate.colours.stage</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">covariate.colours.msi</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see BoutrosLab.plotting.general::covariates.grob() for more information</span></span></span>
<span class="r-in"><span><span class="va">covariate.object.grob</span> <span class="op">&lt;-</span> <span class="fu"><a href="covariates.grob.html">covariates.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="va">covariates.object</span>,</span></span>
<span class="r-in"><span>    ord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    side <span class="op">=</span> <span class="st">'top'</span>,</span></span>
<span class="r-in"><span>    size <span class="op">=</span> <span class="fl">0.8</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create legend to explain covariates</span></span></span>
<span class="r-in"><span><span class="va">covariates.legends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>,<span class="st">'pink'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Sex'</span>,</span></span>
<span class="r-in"><span>        border <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'plum1'</span>, <span class="st">'orchid1'</span>, <span class="st">'orchid3'</span>, <span class="st">'orchid4'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I'</span>,<span class="st">'II'</span>,<span class="st">'III'</span>,<span class="st">'IV'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Stage'</span>,</span></span>
<span class="r-in"><span>        border <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chartreuse4'</span>,<span class="st">'chartreuse2'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MSS'</span>,<span class="st">'MSI-High'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'MSI'</span>,</span></span>
<span class="r-in"><span>        border <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see BoutrosLab.plotting.general::legend.grob() for more information</span></span></span>
<span class="r-in"><span><span class="va">covariate.legend.grob</span> <span class="op">&lt;-</span> <span class="fu"><a href="legend.grob.html">legend.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legends <span class="op">=</span> <span class="va">covariates.legends</span>,</span></span>
<span class="r-in"><span>    title.just <span class="op">=</span> <span class="st">'left'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Covariates', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Covariates'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># removing x-axis formatting to give space to covariates</span></span></span>
<span class="r-in"><span>    xaxis.tck <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">''</span>,<span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="co"># covariates</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">covariate.object.grob</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">covariate.legend.grob</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        y <span class="op">=</span> <span class="op">-</span><span class="fl">0.028</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Sex'</span>,<span class="st">'Stage'</span>,<span class="st">'MSI'</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    bottom.padding <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y,     resolveHJust(x$just, x$hjust), resolveVJust(x$just, x$vjust),     x$rot, 0):</span> polygon edge not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Auto_legend', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Covariates'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Mutations'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># removing x-axis formatting to give space to covariates</span></span></span>
<span class="r-in"><span>    xaxis.tck <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">''</span>,<span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="co"># covariates</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">covariate.legend.grob</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    bottom.padding <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    inside.legend.auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y,     resolveHJust(x$just, x$hjust), resolveVJust(x$just, x$vjust),     x$rot, 0):</span> polygon edge not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Horizontal orientation</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Horizontal', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    <span class="co"># switch formula order</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">samples</span> <span class="op">~</span> <span class="va">values</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Plot horizontally'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the panel layout</span></span></span>
<span class="r-in"><span>    plot.horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    <span class="co"># covariates</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">covariate.legend.grob</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    inside.legend.auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-15.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change bar thickness and add text labels</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Text_Labels', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    <span class="co"># switch formula order</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">samples</span> <span class="op">~</span> <span class="va">values</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Text labels and thin bars'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the panel layout</span></span></span>
<span class="r-in"><span>    plot.horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    box.ratio <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>    add.text <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    text.x <span class="op">=</span> <span class="fl">27.75</span>,</span></span>
<span class="r-in"><span>    text.y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    text.labels <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="st">'values'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    text.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    text.fontface <span class="op">=</span> <span class="st">'italic'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-16.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Error bars</span></span></span>
<span class="r-in"><span><span class="va">error.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sd</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Error_Bars', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    <span class="co"># needs sequential x-axis</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">error.data</span>,</span></span>
<span class="r-in"><span>    y.error.up <span class="op">=</span> <span class="va">error.data</span><span class="op">$</span><span class="va">error</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="va">error.data</span><span class="op">$</span><span class="va">genes</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Error bars'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Change in Expression'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">45</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-17.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Error_Bars_Horizontal', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    <span class="co"># needs sequential x-axis</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">error.data</span>,</span></span>
<span class="r-in"><span>    y.error.up <span class="op">=</span> <span class="va">error.data</span><span class="op">$</span><span class="va">error</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="va">error.data</span><span class="op">$</span><span class="va">genes</span>,</span></span>
<span class="r-in"><span>    plot.horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Error bars'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Change in Expression'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">45</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-18.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grid lines</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Gridlines', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Gridlines'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Grid lines</span></span></span>
<span class="r-in"><span>    add.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    xgrid.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Female'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="co"># Positioning legend on plot</span></span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-19.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grid lines 2</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Gridlines_GreyBG', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Gridlines &amp; grey background'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Grid lines</span></span></span>
<span class="r-in"><span>    background.col <span class="op">=</span> <span class="st">'grey85'</span>,</span></span>
<span class="r-in"><span>    add.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    xgrid.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Female'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="co"># Positioning legend on plot</span></span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-20.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Labels</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Labels', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Labels'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Labels</span></span></span>
<span class="r-in"><span>    text.above.bars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'*'</span>,<span class="st">'27'</span>,<span class="st">'15'</span>,<span class="st">'*'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        padding <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>        bar.locations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        rotation <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Female'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="co"># Positioning legend on plot</span></span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-21.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># lines</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Lines', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Lines'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Lines</span></span></span>
<span class="r-in"><span>    sample.order <span class="op">=</span> <span class="st">'increasing'</span>,</span></span>
<span class="r-in"><span>    line.func <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fl">0.1</span><span class="op">*</span><span class="va">x</span><span class="op">**</span><span class="fl">2</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>    line.from <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    line.to <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>    line.col <span class="op">=</span> <span class="st">'darkgrey'</span>,</span></span>
<span class="r-in"><span>    abline.h <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    abline.col <span class="op">=</span> <span class="st">'red'</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Female'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="co"># Positioning legend on plot</span></span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-22.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Background rectangle</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Bg_Rectangle', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Background rectangle'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    sample.order <span class="op">=</span> <span class="st">'increasing'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Background rectangle</span></span></span>
<span class="r-in"><span>    add.rectangle <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    xleft.rectangle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">14.5</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ybottom.rectangle <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    xright.rectangle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">15.5</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ytop.rectangle <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>    col.rectangle <span class="op">=</span> <span class="st">'lightgrey'</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                        pch <span class="op">=</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Male'</span>,<span class="st">'Female'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span>,</span></span>
<span class="r-in"><span>                    padding.text <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="co"># Positioning legend on plot</span></span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Barplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-23.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Raster</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_with_raster', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">barplot.data</span><span class="op">[</span><span class="va">barplot.data</span><span class="op">$</span><span class="va">mutation</span> <span class="op">==</span> <span class="st">'nonsynonymous'</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Raster fill'</span>,</span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="st">'Nonsynonymous SNVs'</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># filling bars with raster</span></span></span>
<span class="r-in"><span>    raster <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">/</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>    raster.just <span class="op">=</span> <span class="st">'bottom'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Description of image here'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-24.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nature format</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_Nature_style', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Nature style'</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># set style to Nature</span></span></span>
<span class="r-in"><span>    style <span class="op">=</span> <span class="st">'Nature'</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to italicize character variables</span></span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'italicized '</span>, <span class="fu">italic</span><span class="op">(</span><span class="st">'a'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to create en-dashes</span></span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'en dashs: 1'</span>,<span class="st">'\u2013'</span>, <span class="st">'10'</span><span class="op">^</span><span class="st">'\u2013'</span>, <span class="st">''</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Setting resolution to 1200 dpi.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Nature also requires italicized single-letter variables and</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 			en-dashes for ranges and negatives. See example in documentation for how to do this.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Avoid red-green colour schemes, create TIFF files, do not outline the figure or legend.</span>
<span class="r-plt img"><img src="create.barplot-25.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Left Justified Example</span></span></span>
<span class="r-in"><span><span class="fu">create.barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Barplot_TwoTopLabelsLeftJustified', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    <span class="co"># set top label details</span></span></span>
<span class="r-in"><span>    xlab.top.label <span class="op">=</span> <span class="st">'Sample Label'</span>,</span></span>
<span class="r-in"><span>    xlab.top.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.top.x <span class="op">=</span> <span class="op">-</span><span class="fl">0.125</span>,</span></span>
<span class="r-in"><span>    xlab.top.y <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    xlab.top.just <span class="op">=</span> <span class="st">'left'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># set main label details</span></span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Sample Main'</span>,</span></span>
<span class="r-in"><span>    main.just <span class="op">=</span> <span class="st">'left'</span>,</span></span>
<span class="r-in"><span>    main.x <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    main.y <span class="op">=</span> <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>    top.padding <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.barplot-26.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

