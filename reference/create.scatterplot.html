<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Takes a data.frame and creates a scatterplot"><title>Make a scatterplot — create.scatterplot • BoutrosLab.plotting.general</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a scatterplot — create.scatterplot"><meta property="og:description" content="Takes a data.frame and creates a scatterplot"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BoutrosLab.plotting.general</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">7.0.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/uclahs-cds/public-R-BoutrosLab-plotting-general/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Make a scatterplot</h1>
      
      <div class="d-none name"><code>create.scatterplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a data.frame and creates a scatterplot</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create.scatterplot</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  main.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        main.y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.cex <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'~'</span>, <span class="st">''</span>, <span class="va">formula</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'~'</span>, <span class="st">''</span>, <span class="va">formula</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        xlab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ylab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  ylab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>        xlab.top.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab.top.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab.top.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlab.top.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  xlab.top.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        xlab.top.y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xlimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  yat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  yaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xaxis.log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  yaxis.log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  xaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  yaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  yaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  xaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  yaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xaxis.tck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  yaxis.tck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  add.grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xgrid.at <span class="op">=</span> <span class="va">xat</span>,</span>
<span>        ygrid.at <span class="op">=</span> <span class="va">yat</span>,</span>
<span>  grid.colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  horizontal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  col.border <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  axes.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strip.col <span class="op">=</span> <span class="st">'white'</span>,</span>
<span>  strip.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strip.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  y.error.up <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.error.down <span class="op">=</span> <span class="va">y.error.up</span>,</span>
<span>  x.error.right <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x.error.left <span class="op">=</span> <span class="va">x.error.right</span>,</span>
<span>  y.error.bar.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  x.error.bar.col <span class="op">=</span> <span class="va">y.error.bar.col</span>,</span>
<span>  error.whisker.angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  error.bar.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  error.bar.length <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  bottom.padding <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  right.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  left.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  key.top <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  key.left.padding <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ylab.axis.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  axis.key.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as.table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  x.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  y.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  x.relation <span class="op">=</span> <span class="st">'same'</span>,</span>
<span>  y.relation <span class="op">=</span> <span class="st">'same'</span>,</span>
<span>  add.axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  axes.lty <span class="op">=</span> <span class="st">'dashed'</span>,</span>
<span>  add.xyline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xyline.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xyline.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xyline.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  abline.h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  abline.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  abline.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.curves <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  curves.exprs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curves.from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  curves.to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  curves.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  curves.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  curves.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.rectangle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xleft.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ybottom.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xright.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ytop.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.rectangle <span class="op">=</span> <span class="st">'transparent'</span>,</span>
<span>  alpha.rectangle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  points.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  points.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  points.pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  points.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  points.col.border <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  points.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.line.segments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  line.start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line.end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  line.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  text.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  text.guess.labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text.guess.skip.labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  text.guess.ignore.radius <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text.guess.ignore.rectangle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text.guess.radius.factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.guess.buffer.factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.guess.label.position <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  size.units <span class="op">=</span> <span class="st">'in'</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1600</span>,</span>
<span>  enable.warnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  description <span class="op">=</span> <span class="st">'Created with BoutrosLab.plotting.general'</span>,</span>
<span>  style <span class="op">=</span> <span class="st">'BoutrosLab'</span>,</span>
<span>  preload.default <span class="op">=</span> <span class="st">'custom'</span>,</span>
<span>  group.specific.colouring <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use.legacy.settings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inside.legend.auto <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  regions.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        regions.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  regions.stop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  regions.color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  regions.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  regions.alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        lollipop.bar.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lollipop.bar.color <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  <span class="va">...</span></span>
<span>  <span class="op">)</span>;</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>The formula used to extract the x &amp; y components from the data-frame</p></dd>

    <dt>data</dt>
<dd><p>The data-frame to plot</p></dd>

    <dt>filename</dt>
<dd><p>Filename for tiff output, or if NULL returns the trellis object itself</p></dd>

    <dt>groups</dt>
<dd><p>The grouping variable in the data-frame</p></dd>

    <dt>main</dt>
<dd><p>The main title for the plot (space is reclaimed if NULL)</p></dd>

    <dt>main.just</dt>
<dd><p>The justification of the main title for the plot, default is centered</p></dd>

    <dt>main.x</dt>
<dd><p>The x location of the main title, deault is 0.5</p></dd>

    <dt>main.y</dt>
<dd><p>The y location of the main title, default is 0.5</p></dd>

    <dt>main.cex</dt>
<dd><p>Size of text for main plot title</p></dd>

    <dt>xlab.label</dt>
<dd><p>x-axis label</p></dd>

    <dt>ylab.label</dt>
<dd><p>y-axis label</p></dd>

    <dt>xlab.cex</dt>
<dd><p>Size of x-axis label, defaults to 3</p></dd>

    <dt>ylab.cex</dt>
<dd><p>Size of y-axis label, defaults to 3</p></dd>

    <dt>xlab.col</dt>
<dd><p>Colour of the x-axis label, defaults to “black”</p></dd>

    <dt>ylab.col</dt>
<dd><p>Colour of the y-axis label, defaults to “black”</p></dd>

    <dt>xlab.top.label</dt>
<dd><p>The label for the top x-axis</p></dd>

    <dt>xlab.top.cex</dt>
<dd><p>Size of top x-axis label</p></dd>

    <dt>xlab.top.col</dt>
<dd><p>Colour of the top x-axis label</p></dd>

    <dt>xlab.top.just</dt>
<dd><p>Justification of the top x-axis label, defaults to centered</p></dd>

    <dt>xlab.top.x</dt>
<dd><p>The x location of the top x-axis label</p></dd>

    <dt>xlab.top.y</dt>
<dd><p>The y location of the top y-axis label</p></dd>

    <dt>xlimits</dt>
<dd><p>Two-element vector giving the x-axis limits, defaults to automatic</p></dd>

    <dt>ylimits</dt>
<dd><p>Two-element vector giving the y-axis limits, defaults to automatic</p></dd>

    <dt>xat</dt>
<dd><p>Vector listing where the x-axis labels should be drawn, defaults to automatic</p></dd>

    <dt>yat</dt>
<dd><p>Vector listing where the y-axis labels should be drawn, defaults to automatic</p></dd>

    <dt>xaxis.lab</dt>
<dd><p>Vector listing x-axis tick labels, defaults to automatic</p></dd>

    <dt>yaxis.lab</dt>
<dd><p>Vector listing y-axis tick labels, defaults to automatic</p></dd>

    <dt>xaxis.log</dt>
<dd><p>Logical indicating whether x-variable should be in logarithmic scale (and what base if numeric)</p></dd>

    <dt>yaxis.log</dt>
<dd><p>Logical indicating whether y-variable should be in logarithmic scale (and what base if numeric)</p></dd>

    <dt>xaxis.cex</dt>
<dd><p>Size of x-axis scales, defaults to 2</p></dd>

    <dt>yaxis.cex</dt>
<dd><p>Size of y-axis scales, defaults to 2</p></dd>

    <dt>xaxis.rot</dt>
<dd><p>Counterclockwise rotation of text in x-axis scales in degrees, defaults to 0</p></dd>

    <dt>yaxis.rot</dt>
<dd><p>Counterclockwise rotation of text in y-axis scales in degrees, defaults to 0</p></dd>

    <dt>xaxis.fontface</dt>
<dd><p>Fontface for the x-axis scales</p></dd>

    <dt>yaxis.fontface</dt>
<dd><p>Fontface for the y-axis scales</p></dd>

    <dt>xaxis.col</dt>
<dd><p>Colour of the x-axis tick labels, defaults to “black”</p></dd>

    <dt>yaxis.col</dt>
<dd><p>Colour of the y-axis tick labels, defaults to “black”</p></dd>

    <dt>xaxis.tck</dt>
<dd><p>Specifies the length of the tick mark, defaults to 1 for both top and bottom axes</p></dd>

    <dt>yaxis.tck</dt>
<dd><p>Specifies the length of the tick mark, defaults to 1 for both top and bottom axes</p></dd>

    <dt>add.grid</dt>
<dd><p>Logical stating wheter or not the grid should be drawn on the plot</p></dd>

    <dt>xgrid.at</dt>
<dd><p>Vector listing where the x-axis grid lines should be drawn, defaults to xat</p></dd>

    <dt>ygrid.at</dt>
<dd><p>Vector listing where the y-axis grid lines should be drawn, defaults to yat</p></dd>

    <dt>grid.colour</dt>
<dd><p>ability to set individual grid line colours</p></dd>

    <dt>horizontal</dt>
<dd><p>xyplot-specific function that allows you to change if type='h' draws lines to the vertical or horizontal axis</p></dd>

    <dt>type</dt>
<dd><p>Plot type</p></dd>

    <dt>cex</dt>
<dd><p>Character expansion for plotting symbol</p></dd>

    <dt>pch</dt>
<dd><p>Plotting character</p></dd>

    <dt>col</dt>
<dd><p>Point/line colour</p></dd>

    <dt>col.border</dt>
<dd><p>Colour of border when points pch &gt;= 21. Defaults to “black”</p></dd>

    <dt>lwd</dt>
<dd><p>Specifies line width, defaults to 1</p></dd>

    <dt>lty</dt>
<dd><p>Specifies line style, defaults to 1 (solid)</p></dd>

    <dt>alpha</dt>
<dd><p>Specifies line transparency, defaults to 1 (opaque)</p></dd>

    <dt>axes.lwd</dt>
<dd><p>Thickness of width of axes lines</p></dd>

    <dt>strip.col</dt>
<dd><p>Strip background colour, defaults to “white”</p></dd>

    <dt>strip.cex</dt>
<dd><p>Strip title character expansion</p></dd>

    <dt>strip.fontface</dt>
<dd><p>Strip title fontface, defaults to bold</p></dd>

    <dt>y.error.up</dt>
<dd><p>upward error vector. Defaults to NULL. When y.error.up is NULL, vertical error bar is not drawn</p></dd>

    <dt>y.error.down</dt>
<dd><p>Downward error vector. Defaults to y.error.down to show symmetric error bars</p></dd>

    <dt>x.error.right</dt>
<dd><p>Rightward error vector. Defaults to NULL. When x.error.right is NULL, horizontal error bar is not drawn</p></dd>

    <dt>x.error.left</dt>
<dd><p>Leftward error vector. Defaults to x.error.right to show symmetric error bars</p></dd>

    <dt>y.error.bar.col</dt>
<dd><p>Colour of vertical error bar. Defaults to “black”</p></dd>

    <dt>x.error.bar.col</dt>
<dd><p>Colour of horizontal error bar. Defaults to “black”</p></dd>

    <dt>error.whisker.angle</dt>
<dd><p>Angle of the whisker drawn on error bar. Defaults to 90 degree</p></dd>

    <dt>error.bar.lwd</dt>
<dd><p>Error bar line width. Defaults to 1</p></dd>

    <dt>error.bar.length</dt>
<dd><p>Length of the error bar whiskers. Defaults to 0.1</p></dd>

    <dt>key</dt>
<dd><p>A list giving the key (legend). The default suppresses drawing</p></dd>

    <dt>legend</dt>
<dd><p>Add a legend to the plot.  Helpful for adding multiple keys and adding keys to the margins of the plot. See xyplot.</p></dd>

    <dt>top.padding</dt>
<dd><p>A number specifying the distance to the top margin, defaults to 0.1</p></dd>

    <dt>bottom.padding</dt>
<dd><p>A number specifying the distance to the bottom margin, defaults to 0.7</p></dd>

    <dt>right.padding</dt>
<dd><p>A number specifying the distance to the right margin, defaults to 0.1</p></dd>

    <dt>left.padding</dt>
<dd><p>A number specifying the distance to the left margin, defaults to 0.5</p></dd>

    <dt>key.top</dt>
<dd><p>A number specifying the distance at top of key, defaults to 0.1</p></dd>

    <dt>key.left.padding</dt>
<dd><p>Amount of padding to go onto any legend on the left</p></dd>

    <dt>ylab.axis.padding</dt>
<dd><p>A number specifying the distance of ylabel to the y-axis, defaults to 1</p></dd>

    <dt>axis.key.padding</dt>
<dd><p>A number specifying the distance from the y-axis to the key, defaults to 1</p></dd>

    <dt>layout</dt>
<dd><p>A vector specifying the number of columns, rows (e.g., c(2,1). Default is NULL; see lattice::xyplot for more details</p></dd>

    <dt>as.table</dt>
<dd><p>Specifies panel drawing order, default is FALSE which draws panels from bottom left corner, moving right then up. Set to TRUE to draw from top left corner, moving right then down</p></dd>

    <dt>x.spacing</dt>
<dd><p>A number specifying the distance between panels along the x-axis, defaults to 0</p></dd>

    <dt>y.spacing</dt>
<dd><p>A number specifying the distance between panels along the y-axis, defaults to 0</p></dd>

    <dt>x.relation</dt>
<dd><p>Allows x-axis scales to vary if set to “free”, defaults to “same”</p></dd>

    <dt>y.relation</dt>
<dd><p>Allows y-axis scales to vary if set to “free”, defaults to “same”</p></dd>

    <dt>add.axes</dt>
<dd><p>Allow axis lines to be turned on or off, default is FALSE</p></dd>

    <dt>axes.lty</dt>
<dd><p>Specifies axis line style, defaults to “dashed”</p></dd>

    <dt>add.xyline</dt>
<dd><p>Allow y=x line to be drawn, default is FALSE</p></dd>

    <dt>xyline.col</dt>
<dd><p>y=x line colour, defaults to black</p></dd>

    <dt>xyline.lwd</dt>
<dd><p>Specifies y=x line width, defaults to 1</p></dd>

    <dt>xyline.lty</dt>
<dd><p>Specifies y=x line style, defaults to 1 (solid)</p></dd>

    <dt>abline.h</dt>
<dd><p>Allow horizontal line to be drawn, default to NULL</p></dd>

    <dt>abline.v</dt>
<dd><p>Allow vertical line to be drawn, default to NULL</p></dd>

    <dt>abline.col</dt>
<dd><p>Horizontal line colour, defaults to black</p></dd>

    <dt>abline.lwd</dt>
<dd><p>Specifies horizontal line width, defaults to 1</p></dd>

    <dt>abline.lty</dt>
<dd><p>Specifies horizontal line style, defaults to 1 (solid)</p></dd>

    <dt>add.curves</dt>
<dd><p>Allow curves to drawn, default is FALSE</p></dd>

    <dt>curves.exprs</dt>
<dd><p>A list of functions, expressions, or calls using “x” as a variable that specify the curves to be drawn</p></dd>

    <dt>curves.from</dt>
<dd><p>Specifies the x co-ordinates at which the start of each curve should be drawn, defaults to drawing the curves to the left edge of the plotting region</p></dd>

    <dt>curves.to</dt>
<dd><p>Specifies the x co-ordinates at which the end of each curve should be drawn, defaults to drawing the curves to the right edge of the plotting region</p></dd>

    <dt>curves.col</dt>
<dd><p>Specifies colours of curves, default is black for each curve</p></dd>

    <dt>curves.lwd</dt>
<dd><p>Specifies width of curves, default is 1 for each curve</p></dd>

    <dt>curves.lty</dt>
<dd><p>Specifies type of curves, default is 1 (solid) for each curve</p></dd>

    <dt>add.rectangle</dt>
<dd><p>Allow a rectangle to be drawn, default is FALSE</p></dd>

    <dt>xleft.rectangle</dt>
<dd><p>Specifies the left x ooordinate of the rectangle to be drawn</p></dd>

    <dt>ybottom.rectangle</dt>
<dd><p>Specifies the bottom y coordinate of the rectangle to be drawn</p></dd>

    <dt>xright.rectangle</dt>
<dd><p>Specifies the right x coordinate of the rectangle to be drawn</p></dd>

    <dt>ytop.rectangle</dt>
<dd><p>Specifies the top y coordinate of the rectangle to be drawn</p></dd>

    <dt>col.rectangle</dt>
<dd><p>Specifies the colour to fill rectangle's area</p></dd>

    <dt>alpha.rectangle</dt>
<dd><p>Specifies the colour bias of the rectangle to be drawn</p></dd>

    <dt>add.points</dt>
<dd><p>Allow additional points to be drawn, default is FALSE</p></dd>

    <dt>points.x</dt>
<dd><p>The x co-ordinates where additional points should be drawn</p></dd>

    <dt>points.y</dt>
<dd><p>The y co-ordinates where additional points should be drawn</p></dd>

    <dt>points.pch</dt>
<dd><p>The plotting character for additional points</p></dd>

    <dt>points.col</dt>
<dd><p>The colour of additional points</p></dd>

    <dt>points.col.border</dt>
<dd><p>Colour of the border of additional points if points.pch &gt;= 21. Defaults to black</p></dd>

    <dt>points.cex</dt>
<dd><p>The size of additional points</p></dd>

    <dt>add.line.segments</dt>
<dd><p>Allow additional line segments to be drawn, default is FALSE</p></dd>

    <dt>line.start</dt>
<dd><p>The y co-ordinates where additional line segments should start</p></dd>

    <dt>line.end</dt>
<dd><p>The y co-ordinates where additional line segments should end</p></dd>

    <dt>line.col</dt>
<dd><p>The colour of additional line segments, default is black</p></dd>

    <dt>line.lwd</dt>
<dd><p>The line width of additional line segments, default is 1</p></dd>

    <dt>add.text</dt>
<dd><p>Allow additional text to be drawn, default is FALSE</p></dd>

    <dt>text.labels</dt>
<dd><p>Labels for additional text</p></dd>

    <dt>text.x</dt>
<dd><p>The x co-ordinates where additional text should be placed</p></dd>

    <dt>text.y</dt>
<dd><p>The y co-ordinates where additional text should be placed</p></dd>

    <dt>text.col</dt>
<dd><p>The colour of additional text</p></dd>

    <dt>text.cex</dt>
<dd><p>The size of additional text</p></dd>

    <dt>text.fontface</dt>
<dd><p>The fontface for additional text</p></dd>

    <dt>text.guess.labels</dt>
<dd><p>Allows automatic labeling by considering values in text.x and text.y as a data point to be labelled, default is FALSE</p></dd>

    <dt>text.guess.skip.labels</dt>
<dd><p>Provides an option to disregard automatic labelling algorithm if no space is available around a data point, thus forcing labelling if a collision is likely, default is TRUE</p></dd>

    <dt>text.guess.ignore.radius</dt>
<dd><p>Allows the automatic labeling algorithm to ignore the radius space of a data point, useful to label a cluster of data points with a single text box, default is FALSE</p></dd>

    <dt>text.guess.ignore.rectangle</dt>
<dd><p>Allows the atuomatic labeling algorithm to ignore the rectangle space of multiple potential label positions, default is FALSE</p></dd>

    <dt>text.guess.radius.factor</dt>
<dd><p>A numeric value to factor the radius value to alter distance from the label and the data point</p></dd>

    <dt>text.guess.buffer.factor</dt>
<dd><p>A numeric value to factor the buffer value to alter the space which is used to consider if data.points are potentially going to collide</p></dd>

    <dt>text.guess.label.position</dt>
<dd><p>A numeric value between 0 and 360 to specify the percise angle of a text box center and the positive x-axis. Angles move counter-clockwise beginning at the positive x axis</p></dd>

    <dt>height</dt>
<dd><p>Figure height, defaults to 6 inches</p></dd>

    <dt>width</dt>
<dd><p>Figure width, defaults to 6 inches</p></dd>

    <dt>size.units</dt>
<dd><p>Figure units, defaults to inches</p></dd>

    <dt>resolution</dt>
<dd><p>Figure resolution in dpi, defaults to 1600</p></dd>

    <dt>enable.warnings</dt>
<dd><p>Print warnings if set to TRUE, defaults to FALSE</p></dd>

    <dt>description</dt>
<dd><p>Short description of image/plot; default NULL</p></dd>

    <dt>style</dt>
<dd><p>defaults to “BoutrosLab”, also accepts “Nature”, which changes parameters according to Nature formatting requirements</p></dd>

    <dt>preload.default</dt>
<dd><p>ability to set multiple sets of diffrent defaults depending on publication needs</p></dd>

    <dt>group.specific.colouring</dt>
<dd><p>Variable to specify if group specific multi colouring for error bars is enforced</p></dd>

    <dt>use.legacy.settings</dt>
<dd><p>boolean to set wheter or not to use legacy mode settings (font)</p></dd>

    <dt>inside.legend.auto</dt>
<dd><p>boolean specifying whether or not to use the automatic inside legend function</p></dd>

    <dt>regions.labels</dt>
<dd><p>Labels for each of the regions on the lollipop plots bars</p></dd>

    <dt>regions.start</dt>
<dd><p>start x value of each of the regions</p></dd>

    <dt>regions.stop</dt>
<dd><p>stop value for each of the regions</p></dd>

    <dt>regions.color</dt>
<dd><p>color of each of the regions</p></dd>

    <dt>regions.cex</dt>
<dd><p>size of the text of each of the regions</p></dd>

    <dt>regions.alpha</dt>
<dd><p>alpha of each of the regions</p></dd>

    <dt>lollipop.bar.y</dt>
<dd><p>y location of top of the lollipop plot bar -- defaults to right above the bottom y axis</p></dd>

    <dt>lollipop.bar.color</dt>
<dd><p>color of the lollipop plot bar</p></dd>

    <dt>...</dt>
<dd><p>Additional arguments to be passed to xyplot</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>filename</code> is <code>NULL</code> then returns the trellis object, otherwise creates a plot and returns a 0/1 success code.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul C. Boutros</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>If this function is called without capturing the return value, or specifying a filename, it may crash while trying to draw the histogram. In particular, if a script that uses such a call of create histogram is called by reading the script in from the command line, it will fail badly, with an error message about unavailable fonts:<br></p><div class="sourceCode"><pre><code>
    Error in grid.Call.graphics("L_text", as.graphicsAnnot(x$label), x$x,  )
        Invalid font type
    Calls: print ... drawDetails.text -&gt; grid.Call.graphics -&gt; .Call.graphics
    </code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></code>, <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code> or the Lattice book for an overview of the package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simple.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">800</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">800</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="co">#    # filename = tempfile(pattern = 'Scatterplot_Simple', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">scatter.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    sample.one <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">800</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    sample.two <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">800</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    chr <span class="op">=</span> <span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">800</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal Input</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Minimal_Input', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Minimal Input'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Axes &amp; Labels</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Axes_Labels', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Axes &amp; Labels'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Axes and labels</span></span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting space</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Plotting_Space', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Plotting Space'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># change axes accordingly</span></span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fl">2</span> <span class="op">**</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># change axes range accordingly</span></span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">**</span> <span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># format labels</span></span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'2'</span><span class="op">^</span><span class="st">'0'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'2'</span><span class="op">^</span><span class="st">'1'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'2'</span><span class="op">^</span><span class="st">'2'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'2'</span><span class="op">^</span><span class="st">'3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">'2'</span><span class="op">^</span><span class="st">'4'</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Transform the x-axis into log-2 space</span></span></span>
<span class="r-in"><span>    xaxis.log <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour &amp; Plotting Character</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Colour_Pch', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colour &amp; Pch'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    <span class="co"># setting the colour</span></span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="co"># setting the plotting character type &amp; size</span></span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour depth</span></span></span>
<span class="r-in"><span><span class="co"># create colour scheme to illustrate adding a colourkey</span></span></span>
<span class="r-in"><span><span class="va">chr.palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="colour.gradient.html">colour.gradient</a></span><span class="op">(</span><span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">800</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Colour_Depth', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colour Depth'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    <span class="co"># setting the colour</span></span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">chr.palette</span>,</span></span>
<span class="r-in"><span>    <span class="co"># setting the plotting character type &amp; size</span></span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">19</span>,</span></span>
<span class="r-in"><span>    cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># adding key for colours</span></span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.colorkey</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    col <span class="op">=</span> <span class="va">chr.palette</span>,</span></span>
<span class="r-in"><span>                    at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">800</span>,</span></span>
<span class="r-in"><span>                    tick.number <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                    space <span class="op">=</span> <span class="st">'bottom'</span>,</span></span>
<span class="r-in"><span>                    size <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                    width <span class="op">=</span> <span class="fl">1.25</span>,</span></span>
<span class="r-in"><span>                    height <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                        labels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>                        cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                        at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">scatter.data</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">scatter.data</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Groups &amp; Legend</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Groups_Legend', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Groups &amp; Legend'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># using arbitrary groups for the sake of illustration</span></span></span>
<span class="r-in"><span>    groups <span class="op">=</span> <span class="va">scatter.data</span><span class="op">$</span><span class="va">chr</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding legend for groups</span></span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="st">'black'</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">19</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="fl">0.04</span>,</span></span>
<span class="r-in"><span>        y <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Correlation Key</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Correlation_Key', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Correlation Key'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding correlation key</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="get.corr.key.html">get.corr.key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    x <span class="op">=</span> <span class="va">scatter.data</span><span class="op">$</span><span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>                    y <span class="op">=</span> <span class="va">scatter.data</span><span class="op">$</span><span class="va">sample.two</span>,</span></span>
<span class="r-in"><span>                    label.items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'spearman'</span>,<span class="st">'spearman.p'</span>,<span class="st">'kendall'</span>,<span class="st">'beta1'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    alpha.background <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                    key.cex <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="fl">0.04</span>,</span></span>
<span class="r-in"><span>            y <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>            corner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Cannot compute exact p-value with ties</span>
<span class="r-plt img"><img src="create.scatterplot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Panel Organization</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Panel_numeric_conditional', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span> <span class="op">|</span> <span class="va">chr</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Panel'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># set up panel layout</span></span></span>
<span class="r-in"><span>    layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yrelation <span class="op">=</span> <span class="st">'free'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Numeric values detected for conditional variable. If text labels are desired, please convert conditional variable to character.</span>
<span class="r-plt img"><img src="create.scatterplot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">scatter.data</span><span class="op">$</span><span class="va">chromosome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">scatter.data</span><span class="op">$</span><span class="va">chr</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Panel_character_conditional', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span> <span class="op">|</span> <span class="va">chromosome</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Panel'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># set up panel layout</span></span></span>
<span class="r-in"><span>    layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yrelation <span class="op">=</span> <span class="st">'free'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Covariates</span></span></span>
<span class="r-in"><span><span class="va">cov.colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">800</span><span class="op">]</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">cov.colours</span><span class="op">[</span><span class="va">cov.colours</span> <span class="op">==</span> <span class="st">'1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">cov.colours</span><span class="op">[</span><span class="va">cov.colours</span> <span class="op">==</span> <span class="st">'2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">cov.colours</span><span class="op">[</span><span class="va">cov.colours</span> <span class="op">==</span> <span class="st">'3'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">cov.colours</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov.grob</span> <span class="op">&lt;-</span> <span class="fu"><a href="covariates.grob.html">covariates.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="va">cov</span>,</span></span>
<span class="r-in"><span>    ord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cov.colours</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    side <span class="op">=</span> <span class="st">'top'</span>,</span></span>
<span class="r-in"><span>    size <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Chromosome'</span>,</span></span>
<span class="r-in"><span>        border <span class="op">=</span> <span class="st">'transparent'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov.legend.grob</span> <span class="op">&lt;-</span> <span class="fu"><a href="legend.grob.html">legend.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legends <span class="op">=</span> <span class="va">cov.legend</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Covariates', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Covariates'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding covariate &amp; legend</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">cov.grob</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">cov.legend.grob</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Ensuring sufficient spacing for covariate</span></span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Error bars</span></span></span>
<span class="r-in"><span><span class="va">error.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chr <span class="op">=</span> <span class="op">(</span><span class="va">microarray</span><span class="op">$</span><span class="va">Start</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sd</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Error_Bars', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">chr</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">error.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Error Bars'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Base pair location on chromosome one'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene expression change'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># xat = seq(0, 16, 2),</span></span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># xlimits = c(0, 15),</span></span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Format xaxes</span></span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">1000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">2000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">3000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">4000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">5000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">6000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">7000000</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">19</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Specifying error bars</span></span></span>
<span class="r-in"><span>    error.bar.lwd <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    error.whisker.angle <span class="op">=</span> <span class="fl">120</span>,</span></span>
<span class="r-in"><span>    y.error.up <span class="op">=</span> <span class="va">error.data</span><span class="op">$</span><span class="va">error</span>,</span></span>
<span class="r-in"><span>    y.error.bar.col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Error_Bars_MultiColor', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">values</span> <span class="op">~</span> <span class="va">chr</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">error.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Error Bars'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Base pair location on chromosome one'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene expression change'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># xat = seq(0, 16, 2),</span></span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">14</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># xlimits = c(0, 15),</span></span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Format xaxes</span></span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">1000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">2000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">3000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">4000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">5000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">6000000</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="scientific.notation.html">scientific.notation</a></span><span class="op">(</span><span class="fl">7000000</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">19</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Specifying error bars</span></span></span>
<span class="r-in"><span>    error.bar.lwd <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    error.whisker.angle <span class="op">=</span> <span class="fl">120</span>,</span></span>
<span class="r-in"><span>    y.error.up <span class="op">=</span> <span class="va">error.data</span><span class="op">$</span><span class="va">error</span>,</span></span>
<span class="r-in"><span>    y.error.bar.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'black'</span>,<span class="st">'red'</span>,<span class="st">'blue'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    group.specific.colouring <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gridlines</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Gridlines', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Gridlines'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding gridlines</span></span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'p'</span>,<span class="st">'g'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># lines &amp; background rectangle</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Lines_BG', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Lines &amp; BG rectangle'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'p'</span>,<span class="st">'g'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># add xy line</span></span></span>
<span class="r-in"><span>    add.xyline <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    xyline.lty <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    xyline.col <span class="op">=</span> <span class="st">'red'</span>,</span></span>
<span class="r-in"><span>    xyline.lwd <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    <span class="co"># add background rectangle</span></span></span>
<span class="r-in"><span>    add.rectangle <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    xleft.rectangle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">scatter.data</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">800</span><span class="op">*</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xright.rectangle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">scatter.data</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">800</span><span class="op">*</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    ybottom.rectangle <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    ytop.rectangle <span class="op">=</span> <span class="fl">15</span>,</span></span>
<span class="r-in"><span>    col.rectangle <span class="op">=</span> <span class="st">'grey'</span>,</span></span>
<span class="r-in"><span>    alpha.rectangle <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># attach lines to points</span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Lines', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">sample.two</span> <span class="op">~</span> <span class="va">sample.one</span> <span class="op">|</span> <span class="va">chr</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">scatter.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Lines'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># attach lines</span></span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'h'</span>,<span class="st">'p'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Numeric values detected for conditional variable. If text labels are desired, please convert conditional variable to character.</span>
<span class="r-plt img"><img src="create.scatterplot-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ROC curve</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">class.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">observed.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">cutoffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">0.01</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">tprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">fprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">c</span> <span class="kw">in</span> <span class="va">cutoffs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">roc.classification</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">class.values</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>        <span class="va">roc.classification</span><span class="op">[</span><span class="va">class.values</span> <span class="op">&gt;=</span> <span class="va">c</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>;</span></span>
<span class="r-in"><span>        <span class="va">roc.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">roc.classification</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">observed.values</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pred'</span>, <span class="st">'obs'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>;</span></span>
<span class="r-in"><span>        <span class="va">tprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tprs</span>, <span class="va">roc.results</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">roc.results</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">roc.results</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>        <span class="va">fprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fprs</span>, <span class="va">roc.results</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="va">roc.results</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">roc.results</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">roc.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cutoff <span class="op">=</span> <span class="va">cutoffs</span>, TPR <span class="op">=</span> <span class="va">tprs</span>, FPR <span class="op">=</span> <span class="va">fprs</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">points.x</span> <span class="op">&lt;-</span> <span class="va">roc.data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>, <span class="va">roc.data</span><span class="op">$</span><span class="va">cutoff</span><span class="op">)</span>, <span class="st">'FPR'</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">points.y</span> <span class="op">&lt;-</span> <span class="va">roc.data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>, <span class="va">roc.data</span><span class="op">$</span><span class="va">cutoff</span><span class="op">)</span>, <span class="st">'TPR'</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_ROC', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">TPR</span> <span class="op">~</span> <span class="va">FPR</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">roc.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'ROC'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'False positive rate'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'True positive rate'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="st">'s'</span>,</span></span>
<span class="r-in"><span>    lwd <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    add.xyline <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    xyline.col <span class="op">=</span> <span class="st">'grey'</span>,</span></span>
<span class="r-in"><span>    add.points <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    points.x <span class="op">=</span> <span class="va">points.x</span>,</span></span>
<span class="r-in"><span>    points.y <span class="op">=</span> <span class="va">points.y</span>,</span></span>
<span class="r-in"><span>    points.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'blue'</span>, <span class="st">'darkgreen'</span>, <span class="st">'red'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    add.text <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    text.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'cutoff = '</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">''</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co">#text.x = points.x - 0.14,</span></span></span>
<span class="r-in"><span>    <span class="co">#text.y = points.y + 0.03,</span></span></span>
<span class="r-in"><span>    text.x <span class="op">=</span> <span class="va">points.x</span>,</span></span>
<span class="r-in"><span>    text.y <span class="op">=</span> <span class="va">points.y</span>,</span></span>
<span class="r-in"><span>    text.guess.labels <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    text.guess.label.position <span class="op">=</span> <span class="fl">155</span>,</span></span>
<span class="r-in"><span>    text.guess.radius.factor <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Volcano Plots</span></span></span>
<span class="r-in"><span><span class="va">fold.change</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">29</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span>,<span class="fl">30</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fake.microarray</span> <span class="op">&lt;-</span> <span class="va">microarray</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>,<span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">fake.microarray</span><span class="op">[</span>,<span class="fl">30</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="va">fake.microarray</span><span class="op">[</span>,<span class="fl">30</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fold.change</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">fake.microarray</span><span class="op">[</span><span class="va">fake.microarray</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fake.microarray</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">29</span><span class="op">]</span>,y<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">}</span> <span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">fold.change</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fake.microarray</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">29</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fake.microarray</span><span class="op">[</span>, <span class="fl">30</span><span class="op">:</span><span class="fl">58</span><span class="op">]</span>, <span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">p.values.adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.values</span>, <span class="st">'fdr'</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dot.colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p.values</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">dot.colours</span><span class="op">[</span><span class="va">p.values.adjusted</span> <span class="op">&lt;</span> <span class="fl">.05</span> <span class="op">&amp;</span> <span class="va">fold.change</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'green'</span>;</span></span>
<span class="r-in"><span><span class="va">dot.colours</span><span class="op">[</span><span class="va">p.values.adjusted</span> <span class="op">&lt;</span> <span class="fl">.05</span> <span class="op">&amp;</span> <span class="va">fold.change</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'red'</span>;</span></span>
<span class="r-in"><span><span class="va">dot.colours</span><span class="op">[</span><span class="va">p.values.adjusted</span> <span class="op">&gt;</span> <span class="fl">.05</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'black'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">volcano.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    p.values <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">p.values.adjusted</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    fold.change <span class="op">=</span> <span class="va">fold.change</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Volcano_Plot', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">p.values</span> <span class="op">~</span> <span class="va">fold.change</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">volcano.data</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">dot.colours</span>,</span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">8.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'foldChange'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'pValues'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.75</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.75</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Automatic Labeling</span></span></span>
<span class="r-in"><span><span class="va">interesting.fold.change</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">fold.change</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">.9</span> <span class="op">|</span> <span class="va">fold.change</span> <span class="op">&gt;</span> <span class="fl">.9</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">interesting.p.value</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">p.values.adjusted</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">8</span> <span class="op">&amp;</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">p.values.adjusted</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">interesting.points</span> <span class="op">&lt;-</span> <span class="va">interesting.fold.change</span> <span class="op">&amp;</span> <span class="va">interesting.p.value</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">text.x</span> <span class="op">&lt;-</span> <span class="va">fold.change</span><span class="op">[</span><span class="va">interesting.points</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">text.y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">p.values.adjusted</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">interesting.points</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">text.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">)</span><span class="op">[</span><span class="va">interesting.points</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_Volcano_Plot_With_Labels', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">p.values</span> <span class="op">~</span> <span class="va">fold.change</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">volcano.data</span>,</span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">8.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'foldChange'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'pValues'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.75</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.75</span>,</span></span>
<span class="r-in"><span>    add.text <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    text.x <span class="op">=</span> <span class="va">text.x</span>,</span></span>
<span class="r-in"><span>    text.y <span class="op">=</span> <span class="va">text.y</span>,</span></span>
<span class="r-in"><span>    text.labels <span class="op">=</span> <span class="va">text.labels</span>,</span></span>
<span class="r-in"><span>    text.guess.labels <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With line segments</span></span></span>
<span class="r-in"><span><span class="va">line.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.scatterplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">+</span><span class="va">z</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>    <span class="va">line.data</span>,</span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Scatterplot_with_LineSegments', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    cex <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    add.line.segments <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    line.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">line.data</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">line.data</span><span class="op">$</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">line.data</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="va">line.data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>    line.end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">line.data</span><span class="op">$</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">line.data</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="va">line.data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">line.data</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="va">line.data</span><span class="op">$</span><span class="va">y</span> <span class="op">+</span> <span class="va">line.data</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>    line.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'red'</span>,<span class="st">'blue'</span>,<span class="st">'green'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    line.lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lollipop.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">100</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="create.lollipopplot.html">create.lollipopplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Lollipop_Simple', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">lollipop.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Lollipop plot'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">102</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>    fill <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Scatter plot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    regions.start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">26</span>,<span class="fl">48</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    regions.stop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">35</span>,<span class="fl">72</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    regions.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"test 1"</span>, <span class="st">"test2"</span>, <span class="st">"test 3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    regions.color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#66b3ff"</span>, <span class="st">"#5cd65c"</span>, <span class="st">"#ff3333"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.scatterplot-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

