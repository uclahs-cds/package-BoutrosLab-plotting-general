<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Takes a data.frame and writes a hexagonally binned plot"><title>Make a hexagonally binned plot — create.hexbinplot • BoutrosLab.plotting.general</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a hexagonally binned plot — create.hexbinplot"><meta property="og:description" content="Takes a data.frame and writes a hexagonally binned plot"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BoutrosLab.plotting.general</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">7.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Make a hexagonally binned plot</h1>
      
      <div class="d-none name"><code>create.hexbinplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a data.frame and writes a hexagonally binned plot</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  main.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.cex <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        aspect <span class="op">=</span> <span class="st">'xy'</span>,</span>
<span>  trans <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  inv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colour.scheme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>  mincnt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  maxcnt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xbins <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  legend.title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'~'</span>, <span class="st">''</span>, <span class="va">formula</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">'~'</span>, <span class="st">''</span>, <span class="va">formula</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        ylab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        xlab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  ylab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlab.top.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab.top.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        xlab.top.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlab.top.just <span class="op">=</span> <span class="st">'center'</span>,</span>
<span>  xlab.top.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  xlab.top.y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        xlimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylimits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  yat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  yaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  xaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  yaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>        yaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xaxis.tck <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  yaxis.tck <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  yaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>        layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as.table <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  x.relation <span class="op">=</span> <span class="st">'same'</span>,</span>
<span>  y.relation <span class="op">=</span> <span class="st">'same'</span>,</span>
<span>  x.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  y.spacing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  strip.col <span class="op">=</span> <span class="st">'white'</span>,</span>
<span>        strip.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strip.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  add.grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  abline.h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.lty <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        abline.lwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  abline.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  abline.front <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add.xyline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xyline.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>        xyline.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xyline.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  add.curves <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  curves.exprs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curves.from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        curves.to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  curves.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  curves.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  curves.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        add.text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  text.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        text.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  add.axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  top.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  bottom.padding <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        left.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  right.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        add.rectangle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xleft.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ybottom.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xright.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        ytop.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.rectangle <span class="op">=</span> <span class="st">'transparent'</span>,</span>
<span>  alpha.rectangle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        background.col <span class="op">=</span> <span class="st">'transparent'</span>,</span>
<span>  key <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  size.units <span class="op">=</span> <span class="st">'in'</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1600</span>,</span>
<span>  enable.warnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        description <span class="op">=</span> <span class="st">'Created with BoutrosLab.plotting.general'</span>,</span>
<span>  style <span class="op">=</span> <span class="st">'BoutrosLab'</span>,</span>
<span>  preload.default <span class="op">=</span> <span class="st">'custom'</span>,</span>
<span>        use.legacy.settings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        inside.legend.auto <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>;</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>The formula used to extract the x &amp; y components from the data-frame</p></dd>

    <dt>data</dt>
<dd><p>The data-frame to plot</p></dd>

    <dt>filename</dt>
<dd><p>Filename for tiff output, or if NULL (default value) returns the trellis object itself</p></dd>

    <dt>main</dt>
<dd><p>The main title for the plot (space is reclaimed if NULL)</p></dd>

    <dt>main.just</dt>
<dd><p>The justification of the main title for the plot, default is centered</p></dd>

    <dt>main.x</dt>
<dd><p>The x location of the main title, deault is 0.5</p></dd>

    <dt>main.y</dt>
<dd><p>The y location of the main title, default is 0.5</p></dd>

    <dt>main.cex</dt>
<dd><p>Size of the main plot title</p></dd>

    <dt>aspect</dt>
<dd><p>This argument controls the physical aspect ratio of the panels, defaults to “xy”</p></dd>

    <dt>trans</dt>
<dd><p>function specifying a transformation for the counts such as log, defaults to NULL</p></dd>

    <dt>inv</dt>
<dd><p>the inverse transformation of trans, defaults to NULL</p></dd>

    <dt>colour.scheme</dt>
<dd><p>colour scheme to be used, default NULL gives LinGray colour scale</p></dd>

    <dt>colourkey</dt>
<dd><p>logical whether a legend should be drawn, defaults to TRUE</p></dd>

    <dt>colourcut</dt>
<dd><p>Vector of values covering [0, 1] that determine hexagon colour class boundaries and hexagon legend size boundaries. Alternatively, an integer (&lt;= maxcnt) specifying the number of equispaced colourcut values in [0,1].</p></dd>

    <dt>mincnt</dt>
<dd><p>Cells with fewer counts are ignored</p></dd>

    <dt>maxcnt</dt>
<dd><p>Cells with more counts are ignored, defaults to auto-generation</p></dd>

    <dt>xbins</dt>
<dd><p>Number of bins to use in x, defaults to 30</p></dd>

    <dt>legend.title</dt>
<dd><p>character/expression to use in place of default legend title or a named list with elements: lab, x, y; defaults to NULL</p></dd>

    <dt>xlab.label</dt>
<dd><p>X-axis label</p></dd>

    <dt>ylab.label</dt>
<dd><p>Y-axis label</p></dd>

    <dt>xlab.cex</dt>
<dd><p>Size of x-axis label</p></dd>

    <dt>ylab.cex</dt>
<dd><p>Size of y-axis label</p></dd>

    <dt>xlab.col</dt>
<dd><p>Colour of the x-axis label, defaults to “black”</p></dd>

    <dt>ylab.col</dt>
<dd><p>Colour of the y-axis label, defaults to “black”</p></dd>

    <dt>xlab.top.label</dt>
<dd><p>The label for the top x-axis</p></dd>

    <dt>xlab.top.cex</dt>
<dd><p>Size of top x-axis label</p></dd>

    <dt>xlab.top.col</dt>
<dd><p>Colour of the top x-axis label</p></dd>

    <dt>xlab.top.just</dt>
<dd><p>Justification of the top x-axis label, defaults to centered</p></dd>

    <dt>xlab.top.x</dt>
<dd><p>The x location of the top x-axis label</p></dd>

    <dt>xlab.top.y</dt>
<dd><p>The y location of the top y-axis label</p></dd>

    <dt>xlimits</dt>
<dd><p>Two-element vector giving the x-axis limits</p></dd>

    <dt>ylimits</dt>
<dd><p>Two-element vector giving the y-axis limits</p></dd>

    <dt>xat</dt>
<dd><p>Vector listing where the x-axis labels should be drawn</p></dd>

    <dt>yat</dt>
<dd><p>Vector listing where the y-axis labels should be drawn</p></dd>

    <dt>xaxis.lab</dt>
<dd><p>Vector listing x-axis tick labels, defaults to automatic</p></dd>

    <dt>yaxis.lab</dt>
<dd><p>Vector listing y-axis tick labels, defaults to automatic</p></dd>

    <dt>xaxis.cex</dt>
<dd><p>Size of x-axis scales, defaults to 2</p></dd>

    <dt>yaxis.cex</dt>
<dd><p>Size of y-axis scales, defaults to 2</p></dd>

    <dt>xaxis.rot</dt>
<dd><p>Rotation of x-axis tick labels; defaults to 0</p></dd>

    <dt>yaxis.rot</dt>
<dd><p>Rotation of y-axis tick labels; defaults to 0</p></dd>

    <dt>xaxis.col</dt>
<dd><p>Colour of the x-axis tick labels, defaults to “black”</p></dd>

    <dt>yaxis.col</dt>
<dd><p>Colour of the y-axis tick labels, defaults to “black”</p></dd>

    <dt>xaxis.tck</dt>
<dd><p>Specifies the length of the tick marks for x-axis, defaults to 1</p></dd>

    <dt>yaxis.tck</dt>
<dd><p>Specifies the length of the tick marks for y-axis, defaults to 1</p></dd>

    <dt>xaxis.fontface</dt>
<dd><p>Fontface for the x-axis scales</p></dd>

    <dt>yaxis.fontface</dt>
<dd><p>Fontface for the y-axis scales</p></dd>

    <dt>layout</dt>
<dd><p>A vector specifying the number of columns, rows (e.g., c(2,1). Default is NULL.</p></dd>

    <dt>as.table</dt>
<dd><p>Specifies panel drawing order, default is FALSE which draws panels from bottom left corner, moving right then up. Set to TRUE to draw from top left corner, moving right then down</p></dd>

    <dt>x.relation</dt>
<dd><p>Allows x-axis scales to vary if set to “free”, defaults to “same”</p></dd>

    <dt>y.relation</dt>
<dd><p>Allows y-axis scales to vary if set to “free”, defaults to “same”</p></dd>

    <dt>x.spacing</dt>
<dd><p>A number specifying the distance between panels along the x-axis, defaults to 0</p></dd>

    <dt>y.spacing</dt>
<dd><p>A number specifying the distance between panels along the y-axis, defaults to 0</p></dd>

    <dt>strip.col</dt>
<dd><p>Strip background colour, defaults to “white”</p></dd>

    <dt>strip.cex</dt>
<dd><p>Strip title character expansion</p></dd>

    <dt>strip.fontface</dt>
<dd><p>Strip title fontface, defaults to bold</p></dd>

    <dt>add.grid</dt>
<dd><p>Allows grid lines to be turned on or off</p></dd>

    <dt>abline.h</dt>
<dd><p>Specify the superimposed horizontal line(s)</p></dd>

    <dt>abline.v</dt>
<dd><p>Specify the superimposed vertical line(s)</p></dd>

    <dt>abline.lty</dt>
<dd><p>Specify the superimposed line type</p></dd>

    <dt>abline.lwd</dt>
<dd><p>Specify the superimposed line width</p></dd>

    <dt>abline.col</dt>
<dd><p>Specify the superimposed line colour (defaults to black)</p></dd>

    <dt>abline.front</dt>
<dd><p>If an abline and/or a grid has been added, this controls whether they are drawn in front of the hexbins</p></dd>

    <dt>add.xyline</dt>
<dd><p>Allow y=x line to be drawn, default is FALSE</p></dd>

    <dt>xyline.col</dt>
<dd><p>y=x line colour, defaults to black</p></dd>

    <dt>xyline.lwd</dt>
<dd><p>Specifies y=x line width, defaults to 1</p></dd>

    <dt>xyline.lty</dt>
<dd><p>Specifies y=x line style, defaults to 1 (solid)</p></dd>

    <dt>add.curves</dt>
<dd><p>Allow curves to drawn, default is FALSE</p></dd>

    <dt>curves.exprs</dt>
<dd><p>A list of functions, expressions, or calls using “x” as a variable that specify the curves to be drawn</p></dd>

    <dt>curves.from</dt>
<dd><p>Specifies the x co-ordinates at which the start of each curve should be drawn, defaults to drawing the curves to the left edge of the plotting region</p></dd>

    <dt>curves.to</dt>
<dd><p>Specifies the x co-ordinates at which the end of each curve should be drawn, defaults to drawing the curves to the right edge of the plotting region</p></dd>

    <dt>curves.col</dt>
<dd><p>Specifies colours of curves, default is black for each curve</p></dd>

    <dt>curves.lwd</dt>
<dd><p>Specifies width of curves, default is 1 for each curve</p></dd>

    <dt>curves.lty</dt>
<dd><p>Specifies type of curves, default is 1 (solid) for each curve</p></dd>

    <dt>add.text</dt>
<dd><p>Allow additional text to be drawn, default is FALSE</p></dd>

    <dt>text.labels</dt>
<dd><p>Labels for additional text</p></dd>

    <dt>text.x</dt>
<dd><p>The x co-ordinates where additional text should be placed</p></dd>

    <dt>text.y</dt>
<dd><p>The y co-ordinates where additional text should be placed</p></dd>

    <dt>text.col</dt>
<dd><p>The colour of additional text</p></dd>

    <dt>text.cex</dt>
<dd><p>The size of additional text</p></dd>

    <dt>text.fontface</dt>
<dd><p>The fontface for additional text</p></dd>

    <dt>add.axes</dt>
<dd><p>Allow axis lines to be turned on or off</p></dd>

    <dt>top.padding</dt>
<dd><p>A number giving the top padding in multiples of the lattice default</p></dd>

    <dt>bottom.padding</dt>
<dd><p>A number giving the bottom padding in multiples of the lattice default</p></dd>

    <dt>left.padding</dt>
<dd><p>A number giving the left padding in multiples of the lattice default</p></dd>

    <dt>right.padding</dt>
<dd><p>A number giving the right padding in multiples of the lattice default</p></dd>

    <dt>add.rectangle</dt>
<dd><p>Allow a rectangle to be drawn, default is FALSE</p></dd>

    <dt>xleft.rectangle</dt>
<dd><p>Specifies the left x coordinate of the rectangle to be drawn</p></dd>

    <dt>ybottom.rectangle</dt>
<dd><p>Specifies the bottom y coordinate of the rectangle to be drawn</p></dd>

    <dt>xright.rectangle</dt>
<dd><p>Specifies the right x coordinate of the rectangle to be drawn</p></dd>

    <dt>ytop.rectangle</dt>
<dd><p>Specifies the top y coordinate of the rectangle to be drawn</p></dd>

    <dt>col.rectangle</dt>
<dd><p>Specifies the colour to fill the rectangle's area</p></dd>

    <dt>alpha.rectangle</dt>
<dd><p>Specifies the colour bias of the rectangle to be drawn</p></dd>

    <dt>background.col</dt>
<dd><p>Specifies the colour for the background of the plot</p></dd>

    <dt>key</dt>
<dd><p>Add a key to the plot. See xyplot.</p></dd>

    <dt>legend</dt>
<dd><p>Add a legend to the plot.  Helpful for adding multiple keys and adding keys to the margins of the plot. See xyplot.</p></dd>

    <dt>height</dt>
<dd><p>Figure height, defaults to 6 inches</p></dd>

    <dt>width</dt>
<dd><p>Figure width, defaults to 6 inches</p></dd>

    <dt>size.units</dt>
<dd><p>Figure units, defaults to inches</p></dd>

    <dt>resolution</dt>
<dd><p>Figure resolution in dpi, defaults to 1600</p></dd>

    <dt>enable.warnings</dt>
<dd><p>Print warnings if set to TRUE, defaults to FALSE</p></dd>

    <dt>description</dt>
<dd><p>Short description of image/plot; default NULL.</p></dd>

    <dt>style</dt>
<dd><p>defaults to “BoutrosLab”, also accepts “Nature”, which changes parameters according to Nature formatting requirements</p></dd>

    <dt>preload.default</dt>
<dd><p>ability to set multiple sets of diffrent defaults depending on publication needs</p></dd>

    <dt>use.legacy.settings</dt>
<dd><p>boolean to set wheter or not to use legacy mode settings (font)</p></dd>

    <dt>inside.legend.auto</dt>
<dd><p>boolean specifying whether or not to use the automatic inside legend function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>filename</code> is <code>NULL</code> then returns the trellis object, otherwise creates a plot and returns a 0/1 success code.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>WARNING:</b> this function uses highly unusual semantics, different from the rest of the <code>BoutrosLab.plotting.general</code> library.  The underlying hexbinplot function uses an argument called maxcnt to specify the maximum number of counts per cell.  The default behaviour is not sensibly encoded via a <code>NULL</code> or an <code>NA</code>, but instead by using the <code><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></code> function.  As a result, we need to use <code><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></code> semantics to handle this function. This <b>can mess up anything using <code><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></code> </b>including things that generate p-values!</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Maud HW Starmans</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>If this function is called without capturing the return value, or specifying a filename, it may crash while trying to draw the histogram. In particular, if a script that uses such a call of create histogram is called by reading the script in from the command line, it will fail badly, with an error message about unavailable fonts:<br></p><div class="sourceCode"><pre><code>
    Error in grid.Call.graphics("L_text", as.graphicsAnnot(x$label), x$x,  )
        Invalid font type
    Calls: print ... drawDetails.text -&gt; grid.Call.graphics -&gt; .Call.graphics
If 'maxcnt' is passed, make sure it is not smaller than the actual maximum count (value depends on nbins). Otherwise, some data may be lost. If you aren't sure what the actual max count is, run this function without specifying the 'maxcnt' parameter using the desired number of bins.
    </code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></code>, <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code> or the Lattice book for an overview of the package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simple.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Simple', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Simple'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-1.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Simple_underlined_legend_title', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'Counts'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    right.padding <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y,     resolveHJust(x$just, x$hjust), resolveVJust(x$just, x$vjust),     x$rot, 0):</span> polygon edge not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set up data</span></span></span>
<span class="r-in"><span><span class="va">hexbin.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal Input</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Minimal_Input', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Minimal input'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># formatting bins</span></span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># this sets the maximum value plotted -- values greater than this will not appear</span></span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-2.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Axes &amp; Labels</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Axes_Labels', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Axes &amp; labels'</span>,</span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Customize Axes and labels</span></span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-3.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Aspect Ratio</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Aspect_Ratio', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Aspect ratio'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Set the aspect ratio to control plot dimensions</span></span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-4.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour scheme</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Colour_Change', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colour change'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Specify colour scheme</span></span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>,<span class="st">'paleturquoise'</span>,<span class="st">'chartreuse'</span>,<span class="st">'yellow'</span>,</span></span>
<span class="r-in"><span>        <span class="st">'orange'</span>,<span class="st">'red'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-5.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bin sizes</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Bin_Sizes', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Bin sizes'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>,<span class="st">'paleturquoise'</span>,<span class="st">'chartreuse'</span>, <span class="st">'yellow'</span>,</span></span>
<span class="r-in"><span>        <span class="st">'orange'</span>,<span class="st">'red'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Specify bin sizes</span></span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-6.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Correlation Key</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Correlation', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Correlation'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Correlation Key</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>            args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="fu"><a href="get.corr.key.html">get.corr.key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    x <span class="op">=</span> <span class="va">hexbin.data</span><span class="op">$</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>                    y <span class="op">=</span> <span class="va">hexbin.data</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>                    label.items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'beta1'</span>, <span class="st">'spearman'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    alpha.background <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>            y <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>            corner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            draw <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-7.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Grid lines and diagonal</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Gridlines', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Gridlines'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Grid &amp; diagonal</span></span></span>
<span class="r-in"><span>    add.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    add.xyline <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-8.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Large range</span></span></span>
<span class="r-in"><span><span class="co"># Generate some fake data with both very low and very high values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>,<span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,sd<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>,<span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,sd<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fake.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    z <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Range', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">z</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">fake.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Range'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Use colourcut to divide the bins appropriately</span></span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.0002</span>,<span class="fl">0.0004</span>,<span class="fl">0.0008</span>,<span class="fl">0.0016</span>,<span class="fl">0.0032</span>,<span class="fl">0.0064</span>,<span class="fl">0.0128</span>,<span class="fl">0.0256</span>,<span class="fl">0.0512</span>,<span class="fl">0.1024</span>,<span class="fl">0.2048</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.4096</span>,<span class="fl">0.8192</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Change the colour scheme</span></span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span><span class="fu">BTC</span><span class="op">(</span><span class="va">n</span>, beg<span class="op">=</span><span class="fl">1</span>, end<span class="op">=</span><span class="fl">256</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>    background.col <span class="op">=</span> <span class="st">'grey'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-9.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Outliers</span></span></span>
<span class="r-in"><span><span class="co"># Generate data with upper bound outlier</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4000</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fake.data.outlier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    z <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">x</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Outlier', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">z</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">fake.data.outlier</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Outlier'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample 1'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Sample 2'</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Use colourcut to divide the bins appropriately</span></span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.01</span>, length <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.0125</span>,<span class="fl">0.1</span>,length<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.125</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xbins <span class="op">=</span> <span class="fl">15</span>,</span></span>
<span class="r-in"><span>    mincnt <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Change the colour scheme</span></span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span><span class="fu">BTC</span><span class="op">(</span><span class="va">n</span>, beg<span class="op">=</span><span class="fl">1</span>, end<span class="op">=</span><span class="fl">256</span><span class="op">)</span><span class="op">}</span>,</span></span>
<span class="r-in"><span>    background.col <span class="op">=</span> <span class="st">'grey'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-10.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nature style</span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="co"># filename = tempfile(pattern = 'Hexbinplot_Nature_style', fileext = '.tiff'),</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">hexbin.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Nature style'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    xlimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    ylimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">16</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    aspect <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourcut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxcnt <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Grid &amp; diagonal</span></span></span>
<span class="r-in"><span>    add.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    add.xyline <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># set style to Nature</span></span></span>
<span class="r-in"><span>    style <span class="op">=</span> <span class="st">'Nature'</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to italicize character variables</span></span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'italicized '</span>, <span class="fu">italic</span><span class="op">(</span><span class="st">'a'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to create en-dashes</span></span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'en dashs: 1'</span>,<span class="st">'\u2013'</span>, <span class="st">'10'</span><span class="op">^</span><span class="st">'\u2013'</span>, <span class="st">''</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Setting resolution to 1200 dpi.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Nature also requires italicized single-letter variables and en-dashes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 			for ranges and negatives. See example in documentation for how to do this.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Avoid red-green colour schemes, create TIFF files, do not outline the figure or legend</span>
<span class="r-plt img"><img src="create.hexbinplot-11.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiplot different groups</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">73</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Randomly generate groups</span></span></span>
<span class="r-in"><span><span class="va">simple.data</span><span class="op">$</span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">simple.data</span><span class="op">$</span><span class="va">group.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">simple.data</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">groups</span>,</span></span>
<span class="r-in"><span>  <span class="co"># filename = tempfile(</span></span></span>
<span class="r-in"><span>  <span class="co">#      pattern = 'stratified_hexbinplot_numeric_conditioning',</span></span></span>
<span class="r-in"><span>  <span class="co">#      fileext = '.tiff'</span></span></span>
<span class="r-in"><span>  <span class="co">#      ),</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>  strip.col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>  strip.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  strip.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span></span>
<span class="r-in"><span>  resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Numeric values detected for conditional variable. If text labels are desired, please convert conditional variable to character.</span>
<span class="r-plt img"><img src="create.hexbinplot-12.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.hexbinplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">group.labels</span>,</span></span>
<span class="r-in"><span>  <span class="co"># filename = tempfile(</span></span></span>
<span class="r-in"><span>  <span class="co">#      pattern = 'stratified_hexbinplot_factor_conditioning',</span></span></span>
<span class="r-in"><span>  <span class="co">#      fileext = '.tiff'</span></span></span>
<span class="r-in"><span>  <span class="co">#      ),</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="st">'Hexbinplot created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>  strip.col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>  strip.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  strip.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span></span>
<span class="r-in"><span>  resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.hexbinplot-13.jpeg" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

