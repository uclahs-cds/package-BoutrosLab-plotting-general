<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make a dotmap with coloured background — create.dotmap • BoutrosLab.plotting.general</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a dotmap with coloured background — create.dotmap"><meta name="description" content="Takes two data.frames and creates a dotmap with a coloured background. A dotmap is an ordered array of evenly-spaced dots whose size and colour can be user-specified to represent characteristics. For example, size gives the absolute magnitude of the correlation and colour gives the sign of the correlation. The coloured background may indicate p-values."><meta property="og:description" content="Takes two data.frames and creates a dotmap with a coloured background. A dotmap is an ordered array of evenly-spaced dots whose size and colour can be user-specified to represent characteristics. For example, size gives the absolute magnitude of the correlation and colour gives the sign of the correlation. The coloured background may indicate p-values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BoutrosLab.plotting.general</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">7.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/uclahs-cds/package-BoutrosLab-plotting-general/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Make a dotmap with coloured background</h1>

      <div class="d-none name"><code>create.dotmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes two data.frames and creates a dotmap with a coloured background. A dotmap is an ordered array of evenly-spaced dots whose size and colour can be user-specified to represent characteristics. For example, size gives the absolute magnitude of the correlation and colour gives the sign of the correlation. The coloured background may indicate p-values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create.dotmap</span><span class="op">(</span></span>
<span>  <span class="va">x</span>, </span>
<span>  bg.data <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  main.just <span class="op">=</span> <span class="st">"center"</span>, </span>
<span>  main.x <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  main.y <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>, </span>
<span>  pch.border.col <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  add.grid <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>  yaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>  xaxis.rot <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  yaxis.rot <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  main.cex <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  xlab.cex <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  ylab.cex <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  xlab.label <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  ylab.label <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  xlab.col <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  ylab.col <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  xlab.top.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab.top.cex <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  xlab.top.col <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  xlab.top.just <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  xlab.top.x <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  xlab.top.y <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>  yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>  xaxis.col <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  yaxis.col <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  xaxis.tck <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  yaxis.tck <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  axis.top <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  axis.bottom <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  axis.left <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  axis.right <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  top.padding <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  bottom.padding <span class="op">=</span> <span class="fl">0.7</span>, </span>
<span>  right.padding <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  left.padding <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  key.ylab.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">''</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  col.lwd <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>  row.lwd <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>  spot.size.function <span class="op">=</span> <span class="st">'default'</span>, </span>
<span>  spot.colour.function <span class="op">=</span> <span class="st">'default'</span>, </span>
<span>  na.spot.size <span class="op">=</span> <span class="fl">7</span>, </span>
<span>  na.pch <span class="op">=</span> <span class="fl">4</span>, </span>
<span>  na.spot.size.colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  grid.colour <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  colour.scheme <span class="op">=</span> <span class="st">'white'</span>, </span>
<span>  total.colours <span class="op">=</span> <span class="fl">99</span>, </span>
<span>  at <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  colour.centering.value <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  colourkey <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  colourkey.labels.at <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  colourkey.labels <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  colour.alpha <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  bg.alpha <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  fill.colour <span class="op">=</span> <span class="st">'white'</span>, </span>
<span>  key.top <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  height <span class="op">=</span> <span class="fl">6</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">6</span>, </span>
<span>  size.units <span class="op">=</span> <span class="st">'in'</span>, </span>
<span>  resolution <span class="op">=</span> <span class="fl">1600</span>, </span>
<span>  enable.warnings <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  col.colour <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  row.colour <span class="op">=</span> <span class="st">'black'</span>, </span>
<span>  description <span class="op">=</span> <span class="st">'Created with BoutrosLab.plotting.general'</span>,</span>
<span>  add.rectangle <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  xleft.rectangle <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  ybottom.rectangle <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  xright.rectangle <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  ytop.rectangle <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  col.rectangle <span class="op">=</span> <span class="st">'transparent'</span>, </span>
<span>  border.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lwd.rectangle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha.rectangle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>, </span>
<span>  yaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>, </span>
<span>  dot.colour.scheme <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  style <span class="op">=</span> <span class="st">'BoutrosLab'</span>,</span>
<span>  preload.default <span class="op">=</span> <span class="st">'custom'</span>,</span>
<span>        use.legacy.settings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  remove.symmetric <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span>;</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An unstacked data.frame to plot the dotmap</p></dd>

    <dt id="arg-bg-data">bg.data<a class="anchor" aria-label="anchor" href="#arg-bg-data"></a></dt>
<dd><p>An unstacked data.frame to plot the background, of the same size as “x”. Column names specified here may be arbitrary: they are not used in the plot.</p></dd>

    <dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>Filename for tiff output, or if NULL returns the trellis object itself</p></dd>

    <dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>Plotting character</p></dd>

    <dt id="arg-pch-border-col">pch.border.col<a class="anchor" aria-label="anchor" href="#arg-pch-border-col"></a></dt>
<dd><p>Colour of the dot border if using pch = 21:25</p></dd>

    <dt id="arg-add-grid">add.grid<a class="anchor" aria-label="anchor" href="#arg-add-grid"></a></dt>
<dd><p>Should a grid of black-lines separating each column/row be added?</p></dd>

    <dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>The main title for the plot (space is reclaimed if NULL)</p></dd>

    <dt id="arg-main-just">main.just<a class="anchor" aria-label="anchor" href="#arg-main-just"></a></dt>
<dd><p>The justification of the main title for the plot, default is centered</p></dd>

    <dt id="arg-main-x">main.x<a class="anchor" aria-label="anchor" href="#arg-main-x"></a></dt>
<dd><p>The x location of the main title, deault is 0.5</p></dd>

    <dt id="arg-main-y">main.y<a class="anchor" aria-label="anchor" href="#arg-main-y"></a></dt>
<dd><p>The y location of the main title, default is 0.5</p></dd>

    <dt id="arg-xlab-label">xlab.label<a class="anchor" aria-label="anchor" href="#arg-xlab-label"></a></dt>
<dd><p>The label for the x-axis</p></dd>

    <dt id="arg-ylab-label">ylab.label<a class="anchor" aria-label="anchor" href="#arg-ylab-label"></a></dt>
<dd><p>The label for the y-axis</p></dd>

    <dt id="arg-xlab-col">xlab.col<a class="anchor" aria-label="anchor" href="#arg-xlab-col"></a></dt>
<dd><p>Colour of the x-axis label, defaults to “black”</p></dd>

    <dt id="arg-ylab-col">ylab.col<a class="anchor" aria-label="anchor" href="#arg-ylab-col"></a></dt>
<dd><p>Colour of the y-axis label, defaults to “black”</p></dd>

    <dt id="arg-xlab-top-label">xlab.top.label<a class="anchor" aria-label="anchor" href="#arg-xlab-top-label"></a></dt>
<dd><p>The label for the top x-axis</p></dd>

    <dt id="arg-xlab-top-cex">xlab.top.cex<a class="anchor" aria-label="anchor" href="#arg-xlab-top-cex"></a></dt>
<dd><p>Size of top x-axis label</p></dd>

    <dt id="arg-xlab-top-col">xlab.top.col<a class="anchor" aria-label="anchor" href="#arg-xlab-top-col"></a></dt>
<dd><p>Colour of the top x-axis label</p></dd>

    <dt id="arg-xlab-top-just">xlab.top.just<a class="anchor" aria-label="anchor" href="#arg-xlab-top-just"></a></dt>
<dd><p>Justification of the top x-axis label, defaults to centered</p></dd>

    <dt id="arg-xlab-top-x">xlab.top.x<a class="anchor" aria-label="anchor" href="#arg-xlab-top-x"></a></dt>
<dd><p>The x location of the top x-axis label</p></dd>

    <dt id="arg-xlab-top-y">xlab.top.y<a class="anchor" aria-label="anchor" href="#arg-xlab-top-y"></a></dt>
<dd><p>The y location of the top y-axis label</p></dd>

    <dt id="arg-main-cex">main.cex<a class="anchor" aria-label="anchor" href="#arg-main-cex"></a></dt>
<dd><p>Size of text for the main title, defaults to 2</p></dd>

    <dt id="arg-xlab-cex">xlab.cex<a class="anchor" aria-label="anchor" href="#arg-xlab-cex"></a></dt>
<dd><p>Size of x-axis label, defaults to 2</p></dd>

    <dt id="arg-ylab-cex">ylab.cex<a class="anchor" aria-label="anchor" href="#arg-ylab-cex"></a></dt>
<dd><p>Size of y-axis label, defaults to 2</p></dd>

    <dt id="arg-xaxis-lab">xaxis.lab<a class="anchor" aria-label="anchor" href="#arg-xaxis-lab"></a></dt>
<dd><p>Vector listing x-axis tick labels, defaults to colnames(x)</p></dd>

    <dt id="arg-yaxis-lab">yaxis.lab<a class="anchor" aria-label="anchor" href="#arg-yaxis-lab"></a></dt>
<dd><p>Vector listing y-axis tick labels, defaults to rownames(x)</p></dd>

    <dt id="arg-xaxis-cex">xaxis.cex<a class="anchor" aria-label="anchor" href="#arg-xaxis-cex"></a></dt>
<dd><p>Size of x-axis tick labels, defaults to 1.2</p></dd>

    <dt id="arg-yaxis-cex">yaxis.cex<a class="anchor" aria-label="anchor" href="#arg-yaxis-cex"></a></dt>
<dd><p>Size of y-axis tick labels, defaults to 1.5</p></dd>

    <dt id="arg-xaxis-rot">xaxis.rot<a class="anchor" aria-label="anchor" href="#arg-xaxis-rot"></a></dt>
<dd><p>Rotation of x-axis tick labels; defaults to 0</p></dd>

    <dt id="arg-yaxis-rot">yaxis.rot<a class="anchor" aria-label="anchor" href="#arg-yaxis-rot"></a></dt>
<dd><p>Rotation of y-axis tick labels; defaults to 0</p></dd>

    <dt id="arg-xaxis-col">xaxis.col<a class="anchor" aria-label="anchor" href="#arg-xaxis-col"></a></dt>
<dd><p>Colour of the x-axis tick labels, defaults to “black”</p></dd>

    <dt id="arg-yaxis-col">yaxis.col<a class="anchor" aria-label="anchor" href="#arg-yaxis-col"></a></dt>
<dd><p>Colour of the y-axis tick labels, defaults to “black”</p></dd>

    <dt id="arg-xaxis-tck">xaxis.tck<a class="anchor" aria-label="anchor" href="#arg-xaxis-tck"></a></dt>
<dd><p>Specifies the length of the tick marks for x-axis, defaults to 1</p></dd>

    <dt id="arg-yaxis-tck">yaxis.tck<a class="anchor" aria-label="anchor" href="#arg-yaxis-tck"></a></dt>
<dd><p>Specifies the length of the tick marks for y-axis, defaults to 1</p></dd>

    <dt id="arg-axis-top">axis.top<a class="anchor" aria-label="anchor" href="#arg-axis-top"></a></dt>
<dd><p>Specifies the padding on the top of the plot</p></dd>

    <dt id="arg-axis-bottom">axis.bottom<a class="anchor" aria-label="anchor" href="#arg-axis-bottom"></a></dt>
<dd><p>Specifies the padding on the bottom of the plot</p></dd>

    <dt id="arg-axis-left">axis.left<a class="anchor" aria-label="anchor" href="#arg-axis-left"></a></dt>
<dd><p>Specifies the padding on the left of the plot</p></dd>

    <dt id="arg-axis-right">axis.right<a class="anchor" aria-label="anchor" href="#arg-axis-right"></a></dt>
<dd><p>Specifies the padding on the right of the plot</p></dd>

    <dt id="arg-top-padding">top.padding<a class="anchor" aria-label="anchor" href="#arg-top-padding"></a></dt>
<dd><p>A number specifying the distance to the top margin, defaults to 0.1</p></dd>

    <dt id="arg-bottom-padding">bottom.padding<a class="anchor" aria-label="anchor" href="#arg-bottom-padding"></a></dt>
<dd><p>A number specifying the distance to the bottom margin, defaults to 0.7</p></dd>

    <dt id="arg-right-padding">right.padding<a class="anchor" aria-label="anchor" href="#arg-right-padding"></a></dt>
<dd><p>A number specifying the distance to the right margin, defaults to 0.1</p></dd>

    <dt id="arg-left-padding">left.padding<a class="anchor" aria-label="anchor" href="#arg-left-padding"></a></dt>
<dd><p>A number specifying the distance to the left margin, defaults to 0.5</p></dd>

    <dt id="arg-key-ylab-padding">key.ylab.padding<a class="anchor" aria-label="anchor" href="#arg-key-ylab-padding"></a></dt>
<dd><p>a number specifying distance between key and left label</p></dd>

    <dt id="arg-key">key<a class="anchor" aria-label="anchor" href="#arg-key"></a></dt>
<dd><p>A list giving the key (legend). The default suppresses drawing. If the key has a “space” component then extra space will be cleared on that side of the plot for the key</p></dd>

    <dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>Add a legend to the plot. Helpful for adding multiple keys and adding keys to the margins of the plot. See xyplot.</p></dd>

    <dt id="arg-col-lwd">col.lwd<a class="anchor" aria-label="anchor" href="#arg-col-lwd"></a></dt>
<dd><p>Thickness of column grid lines</p></dd>

    <dt id="arg-row-lwd">row.lwd<a class="anchor" aria-label="anchor" href="#arg-row-lwd"></a></dt>
<dd><p>Thickness of row grid lines</p></dd>

    <dt id="arg-spot-size-function">spot.size.function<a class="anchor" aria-label="anchor" href="#arg-spot-size-function"></a></dt>
<dd><p>The function that translates values in x into dotmap spot-size. The default is 0.1 + (2 * abs(x))</p></dd>

    <dt id="arg-spot-colour-function">spot.colour.function<a class="anchor" aria-label="anchor" href="#arg-spot-colour-function"></a></dt>
<dd><p>The function that translates values in x into dotmap spot-colour. The default gives negative values blue, positive values red, and zero white. Parameter also accepts 'columns' and 'rows', which groups the dot colours by columns or rows (not both), respectively. For column/row grouping, there are 12 unique colours and these colours will start to repeat once there are more than 12 columns/rows.</p></dd>

    <dt id="arg-na-spot-size">na.spot.size<a class="anchor" aria-label="anchor" href="#arg-na-spot-size"></a></dt>
<dd><p>The size for plotting character for NA cells. Defaults to 7.</p></dd>

    <dt id="arg-na-pch">na.pch<a class="anchor" aria-label="anchor" href="#arg-na-pch"></a></dt>
<dd><p>The type of plotting character to represent NA cells. Defaults to 4 ('X').</p></dd>

    <dt id="arg-na-spot-size-colour">na.spot.size.colour<a class="anchor" aria-label="anchor" href="#arg-na-spot-size-colour"></a></dt>
<dd><p>Colour for plotting character representing NA cells. Defaults to black.</p></dd>

    <dt id="arg-grid-colour">grid.colour<a class="anchor" aria-label="anchor" href="#arg-grid-colour"></a></dt>
<dd><p>The colour for the grid lines. DEPRECATED</p></dd>

    <dt id="arg-colour-scheme">colour.scheme<a class="anchor" aria-label="anchor" href="#arg-colour-scheme"></a></dt>
<dd><p>Background colouring. Accepts a vector of colours. Vectors of two or three colours are gradiated to create the final palette. Defaults to “white”.</p></dd>

    <dt id="arg-total-colours">total.colours<a class="anchor" aria-label="anchor" href="#arg-total-colours"></a></dt>
<dd><p>Total number of colours to plot for the Background colours</p></dd>

    <dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>A vector specifying the breakpoints along the range of bg; each interval specified by these breakpoints are assigned to a colour from the palette. Defaults to NULL, which corresponds to the range of bg being divided into total.colours equally spaced intervals. If bg has values outside of the range specified by “at”, those values are shown with colours corresponding to the extreme ends of the colour spectrum and a warning is given.</p></dd>

    <dt id="arg-colour-centering-value">colour.centering.value<a class="anchor" aria-label="anchor" href="#arg-colour-centering-value"></a></dt>
<dd><p>What should be the center of the background key</p></dd>

    <dt id="arg-colourkey">colourkey<a class="anchor" aria-label="anchor" href="#arg-colourkey"></a></dt>
<dd><p>Determines if the colour key should be added or not and sets up its formatting. Defaults to FALSE.</p></dd>

    <dt id="arg-colourkey-labels-at">colourkey.labels.at<a class="anchor" aria-label="anchor" href="#arg-colourkey-labels-at"></a></dt>
<dd><p>A vector specifying the tick-positions on the background colourkey</p></dd>

    <dt id="arg-colourkey-labels">colourkey.labels<a class="anchor" aria-label="anchor" href="#arg-colourkey-labels"></a></dt>
<dd><p>A vector specifying tick-labels of the background colourkey</p></dd>

    <dt id="arg-colourkey-cex">colourkey.cex<a class="anchor" aria-label="anchor" href="#arg-colourkey-cex"></a></dt>
<dd><p>Size of the background colourkey label text</p></dd>

    <dt id="arg-colour-alpha">colour.alpha<a class="anchor" aria-label="anchor" href="#arg-colour-alpha"></a></dt>
<dd><p>Bias to be added to background colour selection (uses x^colour.alpha in mapping)</p></dd>

    <dt id="arg-bg-alpha">bg.alpha<a class="anchor" aria-label="anchor" href="#arg-bg-alpha"></a></dt>
<dd><p>The alpha value of the background colours, defaults to 0.5 so that the background does not compete with the dot colours for attention.</p></dd>

    <dt id="arg-fill-colour">fill.colour<a class="anchor" aria-label="anchor" href="#arg-fill-colour"></a></dt>
<dd><p>The background fill colour (only exposed where missing values are present). Defaults to white. NOTE: If you change this colour, you may want to set bg.alpha to 1 to avoid the fill colour showing through</p></dd>

    <dt id="arg-key-top">key.top<a class="anchor" aria-label="anchor" href="#arg-key-top"></a></dt>
<dd><p>A number specifying the distance at top of key, defaults to 0.1</p></dd>

    <dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>Figure height in size.units</p></dd>

    <dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>Figure width in size.units</p></dd>

    <dt id="arg-size-units">size.units<a class="anchor" aria-label="anchor" href="#arg-size-units"></a></dt>
<dd><p>Units of size for the figure</p></dd>

    <dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>Figure resolution in dpi</p></dd>

    <dt id="arg-enable-warnings">enable.warnings<a class="anchor" aria-label="anchor" href="#arg-enable-warnings"></a></dt>
<dd><p>Print warnings if set to TRUE, defaults to FALSE</p></dd>

    <dt id="arg-col-colour">col.colour<a class="anchor" aria-label="anchor" href="#arg-col-colour"></a></dt>
<dd><p>The colour for the column grid lines, defaults to “black”. Can be a vector.</p></dd>

    <dt id="arg-row-colour">row.colour<a class="anchor" aria-label="anchor" href="#arg-row-colour"></a></dt>
<dd><p>The colour for the row grid lines, defaults to “black”. Can be a vector.</p></dd>

    <dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>Description of image/plot; default NULL.</p></dd>

    <dt id="arg-add-rectangle">add.rectangle<a class="anchor" aria-label="anchor" href="#arg-add-rectangle"></a></dt>
<dd><p>Allow a rectangle to be drawn, default is FALSE</p></dd>

    <dt id="arg-xleft-rectangle">xleft.rectangle<a class="anchor" aria-label="anchor" href="#arg-xleft-rectangle"></a></dt>
<dd><p>Specifies the left x ooordinate of the rectangle to be drawn</p></dd>

    <dt id="arg-ybottom-rectangle">ybottom.rectangle<a class="anchor" aria-label="anchor" href="#arg-ybottom-rectangle"></a></dt>
<dd><p>Specifies the bottom y coordinate of the rectangle to be drawn</p></dd>

    <dt id="arg-xright-rectangle">xright.rectangle<a class="anchor" aria-label="anchor" href="#arg-xright-rectangle"></a></dt>
<dd><p>Specifies the right x coordinate of the rectangle to be drawn</p></dd>

    <dt id="arg-ytop-rectangle">ytop.rectangle<a class="anchor" aria-label="anchor" href="#arg-ytop-rectangle"></a></dt>
<dd><p>Specifies the top y coordinate of the rectangle to be drawn</p></dd>

    <dt id="arg-col-rectangle">col.rectangle<a class="anchor" aria-label="anchor" href="#arg-col-rectangle"></a></dt>
<dd><p>Specifies the colour to fill the rectangle's area</p></dd>

    <dt id="arg-alpha-rectangle">alpha.rectangle<a class="anchor" aria-label="anchor" href="#arg-alpha-rectangle"></a></dt>
<dd><p>Specifies the colour bias of the rectangle to be drawn</p></dd>

    <dt id="arg-border-rectangle">border.rectangle<a class="anchor" aria-label="anchor" href="#arg-border-rectangle"></a></dt>
<dd><p>Specifies the colour of the rectangle border</p></dd>

	<dt id="arg-lwd-rectangle">lwd.rectangle<a class="anchor" aria-label="anchor" href="#arg-lwd-rectangle"></a></dt>
<dd><p>Specifies the thickness of the rectangle border</p></dd>

	<dt id="arg-xaxis-fontface">xaxis.fontface<a class="anchor" aria-label="anchor" href="#arg-xaxis-fontface"></a></dt>
<dd><p>Fontface for the x-axis scales</p></dd>

    <dt id="arg-yaxis-fontface">yaxis.fontface<a class="anchor" aria-label="anchor" href="#arg-yaxis-fontface"></a></dt>
<dd><p>Fontface for the y-axis scales</p></dd>

    <dt id="arg-dot-colour-scheme">dot.colour.scheme<a class="anchor" aria-label="anchor" href="#arg-dot-colour-scheme"></a></dt>
<dd><p>Colour Scheme for the dots</p></dd>

    <dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>defaults to “BoutrosLab”, also accepts “Nature”, which changes parameters according to Nature formatting requirements</p></dd>

    <dt id="arg-preload-default">preload.default<a class="anchor" aria-label="anchor" href="#arg-preload-default"></a></dt>
<dd><p>ability to set multiple sets of diffrent defaults depending on publication needs</p></dd>

    <dt id="arg-use-legacy-settings">use.legacy.settings<a class="anchor" aria-label="anchor" href="#arg-use-legacy-settings"></a></dt>
<dd><p>boolean to set wheter or not to use legacy mode settings (font)</p></dd>

    <dt id="arg-remove-symmetric">remove.symmetric<a class="anchor" aria-label="anchor" href="#arg-remove-symmetric"></a></dt>
<dd><p>boolean to set whether or not to remove the top left half of a symettrically sized matrix</p></dd>

    <dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>line width for the axis lines</p></dd>

    </dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It would be nice to have a library of suitable spot.size and spot.colour functions.</p><div class="sourceCode"><pre><code>
    Earlier ideas included:
    (1) Changing the dot shape to triangles, so that upward or downward-pointing dots indicated direction of change. This would allow dot colour to be used to encode something else. This idea was not used because in the case of very small dots, the direction of the triangle might not be visible.
    (2) Adding arrows above or below dots to indicate direction of change. This idea was not used because there may not always be enough space present to add such arrows.
    (3) Adding line(s) in the background set at different angles to show data. This was found to be not intuitive to read.

A future addition may be to add the option of outlining boxes instead of adding a background. This would be applicable in cases where there is very little background space, and consequently, the background colour would not be very visible.
    </code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>filename</code> is <code>NULL</code> then returns the trellis object, otherwise creates a plot and returns a 0/1 success code.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul C. Boutros</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>If this function is called without capturing the return value, or specifying a filename, it may crash while trying to draw the histogram. In particular, if a script that uses such a call of create histogram is called by reading the script in from the command line, it will fail badly, with an error message about unavailable fonts:<br></p><div class="sourceCode"><pre><code>
    Error in grid.Call.graphics("L_text", as.graphicsAnnot(x$label), x$x,  )
        Invalid font type
    Calls: print ... drawDetails.text -&gt; grid.Call.graphics -&gt; .Call.graphics
    </code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></code>, <code><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></code>, <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code> or the Lattice book for an overview of the package.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">simple.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">'A'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'B'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'C'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'D'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'E'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Simple'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Simple'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a function to determine the spot sizes (default function works best with values &lt; 1)</span></span></span>
<span class="r-in"><span><span class="va">spot.size.med</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span>;<span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal Input</span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Minimal_Input'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Minimal input'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="va">spot.size.med</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Axes &amp; Labels</span></span></span>
<span class="r-in"><span><span class="va">spot.size.small</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span>;<span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Axes_Labels'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Axes &amp; labels'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="va">spot.size.small</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the font sizes and labels</span></span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Legend</span></span></span>
<span class="r-in"><span><span class="va">key.sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">2</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Legend'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Legend'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="va">spot.size.small</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Legend for dots</span></span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fu">spot.size.small</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">2</span>, palette.type <span class="op">=</span> <span class="st">'dotmap'</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">19</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Cluster by dots and add dendrogram</span></span></span>
<span class="r-in"><span><span class="va">plot.data</span> <span class="op">&lt;-</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cluster data</span></span></span>
<span class="r-in"><span><span class="va">clustered.data</span> <span class="op">&lt;-</span> <span class="fu">diana</span><span class="op">(</span><span class="va">plot.data</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># order data by cluster</span></span></span>
<span class="r-in"><span><span class="va">plot.data</span> <span class="op">&lt;-</span> <span class="va">plot.data</span><span class="op">[</span><span class="va">clustered.data</span><span class="op">$</span><span class="va">order</span>,<span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create dendogram</span></span></span>
<span class="r-in"><span><span class="va">dendrogram.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="create.dendrogram.html">create.dendrogram</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">plot.data</span>, clustering.method <span class="op">=</span> <span class="st">'diana'</span>,</span></span>
<span class="r-in"><span>  cluster.dimension <span class="op">=</span> <span class="st">'row'</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dendrogram.grob</span> <span class="op">&lt;-</span> <span class="fu">latticeExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/latticeExtra/man/dendrogramGrob.html" class="external-link">dendrogramGrob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="va">dendrogram.data</span>,</span></span>
<span class="r-in"><span>        side <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        type <span class="op">=</span> <span class="st">'rectangle'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create dotmap</span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">plot.data</span>,</span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_clustered_dendrogram'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Clustered &amp; dendrogram'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="va">spot.size.small</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the font sizes and labels</span></span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dendrogram.grob</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    right.padding <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add background data</span></span></span>
<span class="r-in"><span><span class="va">key.sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CNA.colour.function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>    <span class="va">colours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'Red'</span>;</span></span>
<span class="r-in"><span>    <span class="va">colours</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'Blue'</span>;</span></span>
<span class="r-in"><span>    <span class="va">colours</span><span class="op">[</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'transparent'</span>;</span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">colours</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_with_Background'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># added new data for the dots</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Moving the dot-data to be background data</span></span></span>
<span class="r-in"><span>    bg.data <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'black'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Background'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    spot.colour.function <span class="op">=</span> <span class="va">CNA.colour.function</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="fu">CNA.colour.function</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">19</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gain'</span>, <span class="st">'Loss'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'CNA'</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding colourkey for background data</span></span></span>
<span class="r-in"><span>    colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Discrete background colours</span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Discrete_Background'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    bg.data <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Discrete background'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    spot.colour.function <span class="op">=</span> <span class="va">CNA.colour.function</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="fu">CNA.colour.function</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">19</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gain'</span>, <span class="st">'Loss'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'CNA'</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing background colour scheme</span></span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightyellow'</span>,<span class="st">'gold'</span>,<span class="st">'darkorange'</span>, <span class="st">'darkorange3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    bg.alpha <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Dot outlines</span></span></span>
<span class="r-in"><span><span class="va">border.colours</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'transparent'</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>    <span class="va">colours</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'black'</span>;</span></span>
<span class="r-in"><span>    <span class="va">colours</span><span class="op">[</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'transparent'</span>;</span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">colours</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Outlined_Dots'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    bg.data <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Dot outlines'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    spot.colour.function <span class="op">=</span> <span class="va">CNA.colour.function</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>            <span class="co"># Remember to also change the pch in the legend</span></span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>            fill <span class="op">=</span> <span class="fu">CNA.colour.function</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gain'</span>, <span class="st">'Loss'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'CNA'</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightyellow'</span>,<span class="st">'gold'</span>,<span class="st">'darkorange'</span>, <span class="st">'darkorange3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    bg.alpha <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Change the plotting character to one which has an outline</span></span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    pch.border.col <span class="op">=</span> <span class="fu">border.colours</span><span class="op">(</span><span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Covariates &amp; Legend</span></span></span>
<span class="r-in"><span><span class="va">sex.colours</span> <span class="op">&lt;-</span> <span class="va">patient</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colours</span><span class="op">[</span><span class="va">sex.colours</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'dodgerblue'</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colours</span><span class="op">[</span><span class="va">sex.colours</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'pink'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sample.covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov.grob</span> <span class="op">&lt;-</span> <span class="fu"><a href="covariates.grob.html">covariates.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="va">sample.covariate</span>,</span></span>
<span class="r-in"><span>    ord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    side <span class="op">=</span> <span class="st">'top'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sample.cov.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Sex'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="legend.grob.html">legend.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legends <span class="op">=</span> <span class="va">sample.cov.legend</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Covariates'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    bg.data <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Covariates'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    spot.colour.function <span class="op">=</span> <span class="va">CNA.colour.function</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>            fill <span class="op">=</span> <span class="fu">CNA.colour.function</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gain'</span>, <span class="st">'Loss'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'CNA'</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightyellow'</span>,<span class="st">'gold'</span>,<span class="st">'darkorange'</span>, <span class="st">'darkorange3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    bg.alpha <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    pch.border.col <span class="op">=</span> <span class="fu">border.colours</span><span class="op">(</span><span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Insert covariates &amp; legend</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">cov.grob</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        left <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">cov.legend</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Side covariates with label</span></span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span> <span class="op">&lt;-</span> <span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span>;</span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span><span class="op">[</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span><span class="op">[</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span><span class="op">[</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chr.covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">chr.cov.colours</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chr.cov.grob</span> <span class="op">&lt;-</span> <span class="fu"><a href="covariates.grob.html">covariates.grob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="va">chr.covariate</span>,</span></span>
<span class="r-in"><span>    ord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    side <span class="op">=</span> <span class="st">'right'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create dot legend</span></span></span>
<span class="r-in"><span><span class="va">dot.grob</span> <span class="op">&lt;-</span> <span class="fu">draw.key</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>         points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>                pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>                fill <span class="op">=</span> <span class="fu">CNA.colour.function</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>            text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gain'</span>, <span class="st">'Loss'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                <span class="op">)</span>,</span></span>
<span class="r-in"><span>            title <span class="op">=</span> <span class="st">'CNA'</span>,</span></span>
<span class="r-in"><span>            padding.text <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>            background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting up the layout for the joint legends</span></span></span>
<span class="r-in"><span><span class="va">right.layout</span> <span class="op">&lt;-</span> <span class="fu">grid.layout</span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span></span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'lines'</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    heights <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span></span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'npc'</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">right.grob</span> <span class="op">&lt;-</span> <span class="fu">frameGrob</span><span class="op">(</span>layout <span class="op">=</span> <span class="va">right.layout</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">right.grob</span> <span class="op">&lt;-</span> <span class="fu">packGrob</span><span class="op">(</span></span></span>
<span class="r-in"><span>    frame <span class="op">=</span> <span class="va">right.grob</span>,</span></span>
<span class="r-in"><span>    grob <span class="op">=</span> <span class="va">chr.cov.grob</span>,</span></span>
<span class="r-in"><span>    row <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">right.grob</span> <span class="op">&lt;-</span> <span class="fu">packGrob</span><span class="op">(</span></span></span>
<span class="r-in"><span>    frame <span class="op">=</span> <span class="va">right.grob</span>,</span></span>
<span class="r-in"><span>    grob <span class="op">=</span> <span class="va">dot.grob</span>,</span></span>
<span class="r-in"><span>    row <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Covariates_Side'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    bg.data <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Both covariates'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    spot.colour.function <span class="op">=</span> <span class="va">CNA.colour.function</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Sample'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Gene'</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightyellow'</span>,<span class="st">'gold'</span>,<span class="st">'darkorange'</span>, <span class="st">'darkorange3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    bg.alpha <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    pch.border.col <span class="op">=</span> <span class="fu">border.colours</span><span class="op">(</span><span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># insert covariates &amp; legend</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            fun <span class="op">=</span> <span class="va">right.grob</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add side label to covariate</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">temp</span>, position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, more <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">draw.key</span><span class="op">(</span></span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="st">'Covariate Label'</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># position label on the plot</span></span></span>
<span class="r-in"><span>    vp <span class="op">=</span> <span class="fu">viewport</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.86</span>, y <span class="op">=</span> <span class="fl">0.155</span>, height <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">0.5</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    draw <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="create.dotmap-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> latticeKey[plot_31.key.frame] </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> null device </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nature style</span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_Nature_style'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    bg.data <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Nature style'</span>,</span></span>
<span class="r-in"><span>    spot.size.function <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    spot.colour.function <span class="op">=</span> <span class="va">CNA.colour.function</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    ylab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        space <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>        points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>            <span class="co"># Remember to also change the pch in the legend</span></span></span>
<span class="r-in"><span>            pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>            fill <span class="op">=</span> <span class="fu">CNA.colour.function</span><span class="op">(</span><span class="va">key.sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Gain'</span>, <span class="st">'Loss'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            adj <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'CNA'</span>,</span></span>
<span class="r-in"><span>        padding.text <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        background <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    key.top <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightyellow'</span>,<span class="st">'gold'</span>,<span class="st">'darkorange'</span>, <span class="st">'darkorange3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    bg.alpha <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Change the plotting character to one which has an outline</span></span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>    pch.border.col <span class="op">=</span> <span class="fu">border.colours</span><span class="op">(</span><span class="va">CNA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># set style to Nature </span></span></span>
<span class="r-in"><span>    style <span class="op">=</span> <span class="st">'Nature'</span>,</span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to italicize character variables</span></span></span>
<span class="r-in"><span>    ylab.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'italicized '</span>, <span class="fu">italic</span><span class="op">(</span><span class="st">'a'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to create en-dashes</span></span></span>
<span class="r-in"><span>    xlab.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'en dashs: 1'</span>,<span class="st">'\u2013'</span>, <span class="st">'10'</span><span class="op">^</span><span class="st">'\u2013'</span>, <span class="st">''</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Setting resolution to 1200 dpi.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Nature also requires italicized single-letter variables and en-dashes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 			for ranges and negatives. See example in documentation for how to do this.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Avoid red-green colour schemes, create TIFF files, do not outline the figure or legend</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simple.data.sym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">'1'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'2'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'3'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'4'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'5'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'6'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'7'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.dotmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Dotmap_remove_symmetric'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.data.sym</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Simple'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Dotmap created by BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    remove.symmetric <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

