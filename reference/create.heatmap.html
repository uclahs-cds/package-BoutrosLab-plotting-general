<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make a heatmap — create.heatmap • BoutrosLab.plotting.general</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a heatmap — create.heatmap"><meta name="description" content="Takes a data.frame and creates a heatmap"><meta property="og:description" content="Takes a data.frame and creates a heatmap"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BoutrosLab.plotting.general</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">7.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/uclahs-cds/package-BoutrosLab-plotting-general/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Make a heatmap</h1>

      <div class="d-none name"><code>create.heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a data.frame and creates a heatmap</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create.heatmap</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clustering.method <span class="op">=</span> <span class="st">'diana'</span>,</span>
<span>  cluster.dimensions <span class="op">=</span> <span class="st">'both'</span>,</span>
<span>  rows.distance.method <span class="op">=</span> <span class="st">'correlation'</span>,</span>
<span>  cols.distance.method <span class="op">=</span> <span class="st">'correlation'</span>,</span>
<span>  cor.method <span class="op">=</span> <span class="st">'pearson'</span>,</span>
<span>  row.dendrogram <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  col.dendrogram <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plot.dendrograms <span class="op">=</span> <span class="st">'both'</span>,</span>
<span>  force.clustering <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  criteria.list <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  covariates.grid.row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.grid.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.grid.border <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.row.lines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.col.lines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.reorder.grid.index <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covariates.padding <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  covariates.top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  covariates.top.grid.row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.top.grid.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.top.grid.border <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.top.row.lines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.top.col.lines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates.top.reorder.grid.index <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covariates.top.padding <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  covariate.legends <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  legend.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend.title.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend.title.just <span class="op">=</span> <span class="st">'centre'</span>,</span>
<span>  legend.title.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  legend.border <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend.border.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend.layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend.between.col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend.between.row <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend.side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">''</span><span class="op">)</span>,</span>
<span>  main.just <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  main.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main.cex <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  right.size.add <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  top.size.add <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  right.dendrogram.size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  top.dendrogram.size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  scale.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  yaxis.lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.lab.top <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  xaxis.top.cex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yaxis.cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  xlab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ylab.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab.top.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        xlab.top.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  xlab.top.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlab.top.just <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  xlab.top.x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  xlab.top.y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xat.top <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xaxis.tck <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.top.tck <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yaxis.tck <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  yaxis.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  col.pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row.pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell.text <span class="op">=</span> <span class="st">''</span>,</span>
<span>  text.fontface <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  text.position <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  text.offset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  text.use.grid.coordinates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colourkey.cex <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  xaxis.rot <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  xaxis.rot.top <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  yaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xlab.label <span class="op">=</span> <span class="st">''</span> ,</span>
<span>  ylab.label <span class="op">=</span> <span class="st">''</span>,</span>
<span>  xlab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  ylab.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  axes.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  gridline.order <span class="op">=</span> <span class="st">'h'</span>,</span>
<span>  grid.row <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grid.col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force.grid.row <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force.grid.col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  grid.limit <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  row.lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span>,</span>
<span>  col.lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span>,</span>
<span>  colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  total.colours <span class="op">=</span> <span class="fl">99</span>,</span>
<span>  colour.centering.value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  colour.alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fill.colour <span class="op">=</span> <span class="st">'darkgray'</span>,</span>
<span>  at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print.colour.key <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colourkey.labels.at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colourkey.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  bottom.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  right.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  left.padding <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  x.alternating <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  shrink <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row.colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  col.colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  row.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  grid.colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grid.lwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  size.units <span class="op">=</span> <span class="st">'in'</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1600</span>,</span>
<span>  enable.warnings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xaxis.covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xaxis.covariates.y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  yaxis.covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yaxis.covariates.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  description <span class="op">=</span> <span class="st">'Created with BoutrosLab.plotting.general'</span>,</span>
<span>  xaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  yaxis.fontface <span class="op">=</span> <span class="st">'bold'</span>,</span>
<span>  symbols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>borders <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  squares <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  circles <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  same.as.matrix <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  input.colours <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  axis.xlab.padding <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  stratified.clusters.rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stratified.clusters.cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        inside.legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  style <span class="op">=</span> <span class="st">'BoutrosLab'</span>,</span>
<span>  preload.default <span class="op">=</span> <span class="st">'custom'</span>,</span>
<span>        use.legacy.settings <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span>;</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Either a data-frame or a matrix from which the heatmap is to created</p></dd>

    <dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>Filename for tiff output, or if NULL returns the trellis object itself</p></dd>

    <dt id="arg-clustering-method">clustering.method<a class="anchor" aria-label="anchor" href="#arg-clustering-method"></a></dt>
<dd><p>Method used to cluster the records – “none” gives unclustered data. Accepts all agglomerative clustering methods available in hclust, plus “diana” (which is divisive).</p></dd>

    <dt id="arg-cluster-dimensions">cluster.dimensions<a class="anchor" aria-label="anchor" href="#arg-cluster-dimensions"></a></dt>
<dd><p>Should clustering be performed on rows, columns, or both – supersedes setting of plot.dendrograms</p></dd>

    <dt id="arg-rows-distance-method">rows.distance.method<a class="anchor" aria-label="anchor" href="#arg-rows-distance-method"></a></dt>
<dd><p>Method name of the distance measure between rows to be used for clustering. Defaults to “correlation”. Other supported methods are same as in ?dist. Also supports “jaccard” which is useful for clustering categorical variables.  “euclidean” is sometimes more robust when ties cause “Unclusterable matrix: some col-distances are null” errors.  Note, rows and cols are switched due an internal transposition of the data.</p></dd>

    <dt id="arg-cols-distance-method">cols.distance.method<a class="anchor" aria-label="anchor" href="#arg-cols-distance-method"></a></dt>
<dd><p>Method name of the distance measure between columns to be used for clustering. Defaults to “correlation”. Other supported methods are same as in ?dist. Also supports “jaccard” which is useful for clustering categorical variables. “euclidean” is sometimes more robust when ties cause “Unclusterable matrix: some col-distances are null” errors.  Note, rows and cols are switched due an internal transposition of the data.</p></dd>

    <dt id="arg-cor-method">cor.method<a class="anchor" aria-label="anchor" href="#arg-cor-method"></a></dt>
<dd><p>The method used for calculating correlation. Defaults to “pearson”</p></dd>

    <dt id="arg-row-dendrogram">row.dendrogram<a class="anchor" aria-label="anchor" href="#arg-row-dendrogram"></a></dt>
<dd><p>A dendrogram object corresponding to the heatmap rows. If provided, row clustering cannot be performed</p></dd>

    <dt id="arg-col-dendrogram">col.dendrogram<a class="anchor" aria-label="anchor" href="#arg-col-dendrogram"></a></dt>
<dd><p>A dendrogram object corresponding to the heatmap columns. If provided, column clustering cannot be performed</p></dd>

    <dt id="arg-plot-dendrograms">plot.dendrograms<a class="anchor" aria-label="anchor" href="#arg-plot-dendrograms"></a></dt>
<dd><p>If clustering is performed or dendrograms are provided, which dendrograms should be plotted – “none”, “right”, “top”, or “both”</p></dd>

    <dt id="arg-force-clustering">force.clustering<a class="anchor" aria-label="anchor" href="#arg-force-clustering"></a></dt>
<dd><p>Binary to over-ride the control that prevents clustering of too-large matrices</p></dd>

    <dt id="arg-criteria-list">criteria.list<a class="anchor" aria-label="anchor" href="#arg-criteria-list"></a></dt>
<dd><p>A vector indicating which rows should be retained</p></dd>

    <dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Any row-wise covariate annotate to add to the plot, as a fully formed list (placed on right side of plot)</p></dd>

    <dt id="arg-covariates-grid-row">covariates.grid.row<a class="anchor" aria-label="anchor" href="#arg-covariates-grid-row"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying the behaviour of row lines in the right covariate bars</p></dd>

    <dt id="arg-covariates-grid-col">covariates.grid.col<a class="anchor" aria-label="anchor" href="#arg-covariates-grid-col"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying the behaviour of column lines in the right covariate bars</p></dd>

    <dt id="arg-covariates-grid-border">covariates.grid.border<a class="anchor" aria-label="anchor" href="#arg-covariates-grid-border"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying the behaviour of the border around the right covariate bars</p></dd>

    <dt id="arg-covariates-row-lines">covariates.row.lines<a class="anchor" aria-label="anchor" href="#arg-covariates-row-lines"></a></dt>
<dd><p>Vector of row indices where grid lines should be drawn on the right covariate bars. If NULL (default), all row lines are drawn. Ignored if <code>covariates.grid.row</code> is not specified</p></dd>

    <dt id="arg-covariates-col-lines">covariates.col.lines<a class="anchor" aria-label="anchor" href="#arg-covariates-col-lines"></a></dt>
<dd><p>Vector of column indices where grid lines should be drawn on the right covariate bars. If NULL (default), all column lines are drawn. Ignored if <code>covariates.grid.col</code> is not specified</p></dd>

    <dt id="arg-covariates-reorder-grid-index">covariates.reorder.grid.index<a class="anchor" aria-label="anchor" href="#arg-covariates-reorder-grid-index"></a></dt>
<dd><p>Boolean specifying whether grid line indices for the right covariate bars should be re-ordered with clustering</p></dd>

    <dt id="arg-covariates-padding">covariates.padding<a class="anchor" aria-label="anchor" href="#arg-covariates-padding"></a></dt>
<dd><p>Amount of empty space (in “lines”) to place between the right covariate bars and dendrogram</p></dd>

    <dt id="arg-covariates-top">covariates.top<a class="anchor" aria-label="anchor" href="#arg-covariates-top"></a></dt>
<dd><p>Any column-wise covariate annotate to add to the plot, as a fully formed list</p></dd>

    <dt id="arg-covariates-top-grid-row">covariates.top.grid.row<a class="anchor" aria-label="anchor" href="#arg-covariates-top-grid-row"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying the behaviour of row lines in the top covariate bars</p></dd>

    <dt id="arg-covariates-top-grid-col">covariates.top.grid.col<a class="anchor" aria-label="anchor" href="#arg-covariates-top-grid-col"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying the behaviour of column lines in the top covariate bars</p></dd>

    <dt id="arg-covariates-top-grid-border">covariates.top.grid.border<a class="anchor" aria-label="anchor" href="#arg-covariates-top-grid-border"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying the behaviour of the border around the top covariate bars</p></dd>

    <dt id="arg-covariates-top-row-lines">covariates.top.row.lines<a class="anchor" aria-label="anchor" href="#arg-covariates-top-row-lines"></a></dt>
<dd><p>Vector of row indices where grid lines should be drawn on the top covariate bars. If NULL (default), all row lines are drawn. Ignored if <code>covariates.top.grid.row</code> is not specified</p></dd>

    <dt id="arg-covariates-top-col-lines">covariates.top.col.lines<a class="anchor" aria-label="anchor" href="#arg-covariates-top-col-lines"></a></dt>
<dd><p>Vector of column indices where grid lines should be drawn on the top covariate bars. If NULL (default), all column lines are drawn. Ignored if <code>covariates.top.grid.col</code> is not specified</p></dd>

    <dt id="arg-covariates-top-reorder-grid-index">covariates.top.reorder.grid.index<a class="anchor" aria-label="anchor" href="#arg-covariates-top-reorder-grid-index"></a></dt>
<dd><p>Boolean specifying whether grid line indices for the top covariate bars should be re-ordered with clustering</p></dd>

    <dt id="arg-covariates-top-padding">covariates.top.padding<a class="anchor" aria-label="anchor" href="#arg-covariates-top-padding"></a></dt>
<dd><p>Amount of empty space (in “lines”) to place between the top covariate bars and dendrogram</p></dd>

    <dt id="arg-covariate-legends">covariate.legends<a class="anchor" aria-label="anchor" href="#arg-covariate-legends"></a></dt>
<dd><p>A list defining covariate legends to add to the plot. See <code>legends</code> argument of <code>legend.grob</code> for more information</p></dd>

    <dt id="arg-legend-cex">legend.cex<a class="anchor" aria-label="anchor" href="#arg-legend-cex"></a></dt>
<dd><p>Size of text labels in covariate legends, defaults to 1</p></dd>

    <dt id="arg-legend-title-cex">legend.title.cex<a class="anchor" aria-label="anchor" href="#arg-legend-title-cex"></a></dt>
<dd><p>Size of title text in covariate legends, defaults to 1</p></dd>

    <dt id="arg-legend-title-just">legend.title.just<a class="anchor" aria-label="anchor" href="#arg-legend-title-just"></a></dt>
<dd><p>Justification of title text in covariate legends, defaults to “centre”</p></dd>

    <dt id="arg-legend-title-fontface">legend.title.fontface<a class="anchor" aria-label="anchor" href="#arg-legend-title-fontface"></a></dt>
<dd><p>Font face of title text in covariate legends – “plain”, “bold”, “italic”, etc.</p></dd>

    <dt id="arg-legend-border">legend.border<a class="anchor" aria-label="anchor" href="#arg-legend-border"></a></dt>
<dd><p>A list of parameters passed to <code>gpar</code> specifying line options for the legend border, defaults to NULL (no border drawn)</p></dd>

    <dt id="arg-legend-border-padding">legend.border.padding<a class="anchor" aria-label="anchor" href="#arg-legend-border-padding"></a></dt>
<dd><p>The amount of empty space (split equally on both sides) to add between the legend and its border, in “lines” units</p></dd>

    <dt id="arg-legend-layout">legend.layout<a class="anchor" aria-label="anchor" href="#arg-legend-layout"></a></dt>
<dd><p>Numeric vector of length 2 specifying the number of columns and rows for the legend layout, defaults to a logical layout based on <code>legend.side</code></p></dd>

    <dt id="arg-legend-between-col">legend.between.col<a class="anchor" aria-label="anchor" href="#arg-legend-between-col"></a></dt>
<dd><p>Amount of space to add between columns in the layout, in “lines” units</p></dd>

    <dt id="arg-legend-between-row">legend.between.row<a class="anchor" aria-label="anchor" href="#arg-legend-between-row"></a></dt>
<dd><p>Amount of space to add between rows in the layout, in “lines” units</p></dd>

    <dt id="arg-legend-side">legend.side<a class="anchor" aria-label="anchor" href="#arg-legend-side"></a></dt>
<dd><p>Side of the plot where the legends should be drawn – “left”, “right”, or “top”</p></dd>

    <dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>The main title for the plot (space is reclaimed if NULL)</p></dd>

    <dt id="arg-main-just">main.just<a class="anchor" aria-label="anchor" href="#arg-main-just"></a></dt>
<dd><p>The justification of the main title for the plot, default is centered</p></dd>

    <dt id="arg-main-x">main.x<a class="anchor" aria-label="anchor" href="#arg-main-x"></a></dt>
<dd><p>The x location of the main title, deault is 0.5</p></dd>

    <dt id="arg-main-y">main.y<a class="anchor" aria-label="anchor" href="#arg-main-y"></a></dt>
<dd><p>The y location of the main title, default is 0.5</p></dd>

    <dt id="arg-main-cex">main.cex<a class="anchor" aria-label="anchor" href="#arg-main-cex"></a></dt>
<dd><p>Size of text for main plot title, defaults to 2.5</p></dd>

    <dt id="arg-right-size-add">right.size.add<a class="anchor" aria-label="anchor" href="#arg-right-size-add"></a></dt>
<dd><p>The size of each extra covariate row in the right dendrogram in units of “lines”</p></dd>

    <dt id="arg-top-size-add">top.size.add<a class="anchor" aria-label="anchor" href="#arg-top-size-add"></a></dt>
<dd><p>The size of each extra covariate row in the top dendrogram in units of “lines”</p></dd>

    <dt id="arg-right-dendrogram-size">right.dendrogram.size<a class="anchor" aria-label="anchor" href="#arg-right-dendrogram-size"></a></dt>
<dd><p>Size of right dendrogram</p></dd>

    <dt id="arg-top-dendrogram-size">top.dendrogram.size<a class="anchor" aria-label="anchor" href="#arg-top-dendrogram-size"></a></dt>
<dd><p>Size of top dendrogram</p></dd>

    <dt id="arg-scale-data">scale.data<a class="anchor" aria-label="anchor" href="#arg-scale-data"></a></dt>
<dd><p>TRUE/FALSE to do row-wise scaling with mean-centering and sd-scaling</p></dd>

    <dt id="arg-xaxis-lab">xaxis.lab<a class="anchor" aria-label="anchor" href="#arg-xaxis-lab"></a></dt>
<dd><p>A vector of row labels, NA = use existing rownames, NULL = none</p></dd>

    <dt id="arg-xaxis-lab-top">xaxis.lab.top<a class="anchor" aria-label="anchor" href="#arg-xaxis-lab-top"></a></dt>
<dd><p>The label for the top x-axis. Required only if you want to print a top *and* bottom xaxis, otherwise use x.alternating = 2 for top axis only. Defaults to NULL</p></dd>

    <dt id="arg-yaxis-lab">yaxis.lab<a class="anchor" aria-label="anchor" href="#arg-yaxis-lab"></a></dt>
<dd><p>A vector of col labels, NA = use existing colnames, NULL = none</p></dd>

    <dt id="arg-xaxis-cex">xaxis.cex<a class="anchor" aria-label="anchor" href="#arg-xaxis-cex"></a></dt>
<dd><p>Size of x-axis label text - defaults to values found in a look-up table</p></dd>

    <dt id="arg-xaxis-top-cex">xaxis.top.cex<a class="anchor" aria-label="anchor" href="#arg-xaxis-top-cex"></a></dt>
<dd><p>Size of top x axis label text</p></dd>

    <dt id="arg-yaxis-cex">yaxis.cex<a class="anchor" aria-label="anchor" href="#arg-yaxis-cex"></a></dt>
<dd><p>Size of y-axis label text - defaults to values found in a look-up table</p></dd>

    <dt id="arg-xaxis-rot">xaxis.rot<a class="anchor" aria-label="anchor" href="#arg-xaxis-rot"></a></dt>
<dd><p>Rotation of x-axis tick labels; defaults to 90</p></dd>

	<dt id="arg-xaxis-rot-top">xaxis.rot.top<a class="anchor" aria-label="anchor" href="#arg-xaxis-rot-top"></a></dt>
<dd><p>Rotation of the top x-axis tick labels; defaults to 90</p></dd>

    <dt id="arg-yaxis-rot">yaxis.rot<a class="anchor" aria-label="anchor" href="#arg-yaxis-rot"></a></dt>
<dd><p>Rotation of y-axis tick labels; defaults to 0</p></dd>

    <dt id="arg-xaxis-col">xaxis.col<a class="anchor" aria-label="anchor" href="#arg-xaxis-col"></a></dt>
<dd><p>Colour of the x-axis tick labels, defaults to “black”</p></dd>

    <dt id="arg-yaxis-col">yaxis.col<a class="anchor" aria-label="anchor" href="#arg-yaxis-col"></a></dt>
<dd><p>Colour of the y-axis tick labels, defaults to “black”</p></dd>

    <dt id="arg-xlab-label">xlab.label<a class="anchor" aria-label="anchor" href="#arg-xlab-label"></a></dt>
<dd><p>The label for the x-axis</p></dd>

    <dt id="arg-ylab-label">ylab.label<a class="anchor" aria-label="anchor" href="#arg-ylab-label"></a></dt>
<dd><p>The label for the y-axis</p></dd>

    <dt id="arg-xlab-cex">xlab.cex<a class="anchor" aria-label="anchor" href="#arg-xlab-cex"></a></dt>
<dd><p>Size of x-axis label, defaults to 2</p></dd>

    <dt id="arg-ylab-cex">ylab.cex<a class="anchor" aria-label="anchor" href="#arg-ylab-cex"></a></dt>
<dd><p>Size of y-axis label, defaults to 2</p></dd>

    <dt id="arg-xlab-col">xlab.col<a class="anchor" aria-label="anchor" href="#arg-xlab-col"></a></dt>
<dd><p>Colour of the x-axis label, defaults to “black”</p></dd>

    <dt id="arg-ylab-col">ylab.col<a class="anchor" aria-label="anchor" href="#arg-ylab-col"></a></dt>
<dd><p>Colour of the y-axis label, defaults to “black”</p></dd>

    <dt id="arg-xlab-top-label">xlab.top.label<a class="anchor" aria-label="anchor" href="#arg-xlab-top-label"></a></dt>
<dd><p>The label for the top x-axis</p></dd>

    <dt id="arg-xlab-top-cex">xlab.top.cex<a class="anchor" aria-label="anchor" href="#arg-xlab-top-cex"></a></dt>
<dd><p>Size of top x-axis label</p></dd>

    <dt id="arg-xlab-top-col">xlab.top.col<a class="anchor" aria-label="anchor" href="#arg-xlab-top-col"></a></dt>
<dd><p>Colour of the top x-axis label</p></dd>

    <dt id="arg-xlab-top-just">xlab.top.just<a class="anchor" aria-label="anchor" href="#arg-xlab-top-just"></a></dt>
<dd><p>Justification of the top x-axis label, defaults to centered</p></dd>

    <dt id="arg-xlab-top-x">xlab.top.x<a class="anchor" aria-label="anchor" href="#arg-xlab-top-x"></a></dt>
<dd><p>The x location of the top x-axis label</p></dd>

    <dt id="arg-xlab-top-y">xlab.top.y<a class="anchor" aria-label="anchor" href="#arg-xlab-top-y"></a></dt>
<dd><p>The y location of the top y-axis label</p></dd>

    <dt id="arg-xat">xat<a class="anchor" aria-label="anchor" href="#arg-xat"></a></dt>
<dd><p>Vector listing where the x-axis labels should be drawn, defaults to automatic</p></dd>

    <dt id="arg-xat-top">xat.top<a class="anchor" aria-label="anchor" href="#arg-xat-top"></a></dt>
<dd><p>Vector listing where the x-axis labels should be drawn on the top of the plot. Required only when you want bottom and top axis, otherwise use x.alternating = 2, to get top axis only. Defaults to NULL</p></dd>

    <dt id="arg-yat">yat<a class="anchor" aria-label="anchor" href="#arg-yat"></a></dt>
<dd><p>Vector listing where the y-axis labels should be drawn, defaults to automatic</p></dd>

    <dt id="arg-xaxis-tck">xaxis.tck<a class="anchor" aria-label="anchor" href="#arg-xaxis-tck"></a></dt>
<dd><p>Size of x-axis tick marks. Defaults to NULL for intelligent choice based on covariate size.</p></dd>

    <dt id="arg-xaxis-top-tck">xaxis.top.tck<a class="anchor" aria-label="anchor" href="#arg-xaxis-top-tck"></a></dt>
<dd><p>Size of top x-axis tick marks. Defaults to NULL for intelligent choice based on covariate size.</p></dd>

    <dt id="arg-yaxis-tck">yaxis.tck<a class="anchor" aria-label="anchor" href="#arg-yaxis-tck"></a></dt>
<dd><p>Size of y-axis tick marks. Defaults to NULL for intelligent choice based on covariate size.</p></dd>

    <dt id="arg-col-pos">col.pos<a class="anchor" aria-label="anchor" href="#arg-col-pos"></a></dt>
<dd><p>Vector of column positions for adding text to cell, defaults to NULL</p></dd>

    <dt id="arg-row-pos">row.pos<a class="anchor" aria-label="anchor" href="#arg-row-pos"></a></dt>
<dd><p>Vector of row positions for adding text to cell, defaults to NULL</p></dd>

    <dt id="arg-cell-text">cell.text<a class="anchor" aria-label="anchor" href="#arg-cell-text"></a></dt>
<dd><p>Text to add to cell, defaults to an empty string</p></dd>

    <dt id="arg-text-fontface">text.fontface<a class="anchor" aria-label="anchor" href="#arg-text-fontface"></a></dt>
<dd><p>1 = Plain, 2 = Bold, 3 = Italic, default is 1</p></dd>

    <dt id="arg-text-cex">text.cex<a class="anchor" aria-label="anchor" href="#arg-text-cex"></a></dt>
<dd><p>Text size, default is 1</p></dd>

    <dt id="arg-text-col">text.col<a class="anchor" aria-label="anchor" href="#arg-text-col"></a></dt>
<dd><p>Text colour, default is black.</p></dd>

    <dt id="arg-text-position">text.position<a class="anchor" aria-label="anchor" href="#arg-text-position"></a></dt>
<dd><p>The position of the text, defaults to center.</p></dd>

    <dt id="arg-text-offset">text.offset<a class="anchor" aria-label="anchor" href="#arg-text-offset"></a></dt>
<dd><p>The offset of the position, defaults to 0.</p></dd>

    <dt id="arg-text-use-grid-coordinates">text.use.grid.coordinates<a class="anchor" aria-label="anchor" href="#arg-text-use-grid-coordinates"></a></dt>
<dd><p>Indetifier if grid coordinates or npc coordinates should be used</p></dd>

    <dt id="arg-colourkey-cex">colourkey.cex<a class="anchor" aria-label="anchor" href="#arg-colourkey-cex"></a></dt>
<dd><p>Size of colourkey label text</p></dd>

    <dt id="arg-axes-lwd">axes.lwd<a class="anchor" aria-label="anchor" href="#arg-axes-lwd"></a></dt>
<dd><p>Width of heatmap border. Note it also changes the colourkey border and ticks</p></dd>

    <dt id="arg-gridline-order">gridline.order<a class="anchor" aria-label="anchor" href="#arg-gridline-order"></a></dt>
<dd><p>Character specifying order in which to draw interior grid-lines ('h' or 'v'). Defaults to 'h' for horizontal first.</p></dd>

    <dt id="arg-grid-row">grid.row<a class="anchor" aria-label="anchor" href="#arg-grid-row"></a></dt>
<dd><p>Allow turning off of the interior grid-lines. Default FALSE</p></dd>

    <dt id="arg-grid-col">grid.col<a class="anchor" aria-label="anchor" href="#arg-grid-col"></a></dt>
<dd><p>Allow turning off of the interior grid-lines. Default FALSE</p></dd>

    <dt id="arg-force-grid-row">force.grid.row<a class="anchor" aria-label="anchor" href="#arg-force-grid-row"></a></dt>
<dd><p>Overrides default behaviour of turning off grid lines when number of rows exceed grid.limit. Defaults to FALSE</p></dd>

    <dt id="arg-force-grid-col">force.grid.col<a class="anchor" aria-label="anchor" href="#arg-force-grid-col"></a></dt>
<dd><p>Overrides default behaviour of turning off grid lines when number of columns exceed grid.limit. Defaults to FALSE</p></dd>

    <dt id="arg-grid-limit">grid.limit<a class="anchor" aria-label="anchor" href="#arg-grid-limit"></a></dt>
<dd><p>Limit set for when to turn off column and row lines if data size exceeds it. Defaults to 50</p></dd>

    <dt id="arg-row-lines">row.lines<a class="anchor" aria-label="anchor" href="#arg-row-lines"></a></dt>
<dd><p>Vector specifying location of lines, default is seq(1, ncol(x), 1) + 0.5. Note: Add 0.5 to customized vector</p></dd>

    <dt id="arg-col-lines">col.lines<a class="anchor" aria-label="anchor" href="#arg-col-lines"></a></dt>
<dd><p>Vector specifying location of lines, default is seq(1, nrow(x), 1) + 0.5. Note: Add 0.5 to customized vector</p></dd>

    <dt id="arg-colour-scheme">colour.scheme<a class="anchor" aria-label="anchor" href="#arg-colour-scheme"></a></dt>
<dd><p>Heatmap colouring. Accepts old-style themes, or a vector of either two or three colours that are gradiated to create the final palette.</p></dd>

    <dt id="arg-total-colours">total.colours<a class="anchor" aria-label="anchor" href="#arg-total-colours"></a></dt>
<dd><p>Total number of colours to plot</p></dd>

    <dt id="arg-colour-centering-value">colour.centering.value<a class="anchor" aria-label="anchor" href="#arg-colour-centering-value"></a></dt>
<dd><p>What should be the center of the colour-map</p></dd>

    <dt id="arg-colour-alpha">colour.alpha<a class="anchor" aria-label="anchor" href="#arg-colour-alpha"></a></dt>
<dd><p>Bias to be added to colour selection (uses x^colour.alpha in mapping). Set to “automatic” for auto-adjustment.</p></dd>

    <dt id="arg-fill-colour">fill.colour<a class="anchor" aria-label="anchor" href="#arg-fill-colour"></a></dt>
<dd><p>The background fill (only exposed where missing values are present</p></dd>

    <dt id="arg-print-colour-key">print.colour.key<a class="anchor" aria-label="anchor" href="#arg-print-colour-key"></a></dt>
<dd><p>Should the colour key be printed at all?</p></dd>

    <dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>A vector specifying the breakpoints along the range of x; each interval specified by these breakpoints are assigned to a colour from the palette. Defaults to NULL, which corresponds to the range of x being divided into total.colours equally spaced intervals. If x has values outside of the range specified by “at” those values are shown with the colours corresponding to the extreme ends of the colour spectrum and a warning is given.</p></dd>

    <dt id="arg-colourkey-labels-at">colourkey.labels.at<a class="anchor" aria-label="anchor" href="#arg-colourkey-labels-at"></a></dt>
<dd><p>A vector specifying the tick-positions on the colourkey</p></dd>

    <dt id="arg-colourkey-labels">colourkey.labels<a class="anchor" aria-label="anchor" href="#arg-colourkey-labels"></a></dt>
<dd><p>A vector specifying tick-labels of the colourkey</p></dd>

    <dt id="arg-top-padding">top.padding<a class="anchor" aria-label="anchor" href="#arg-top-padding"></a></dt>
<dd><p>A number specifying the distance to the top margin, defaults to 0.1</p></dd>

    <dt id="arg-bottom-padding">bottom.padding<a class="anchor" aria-label="anchor" href="#arg-bottom-padding"></a></dt>
<dd><p>A number specifying the distance to the bottom margin, defaults to 0.5</p></dd>

    <dt id="arg-right-padding">right.padding<a class="anchor" aria-label="anchor" href="#arg-right-padding"></a></dt>
<dd><p>A number specifying the distance to the right margin, defaults to 0.5</p></dd>

    <dt id="arg-left-padding">left.padding<a class="anchor" aria-label="anchor" href="#arg-left-padding"></a></dt>
<dd><p>A number specifying the distance to the left margin, defaults to 0.5</p></dd>

    <dt id="arg-x-alternating">x.alternating<a class="anchor" aria-label="anchor" href="#arg-x-alternating"></a></dt>
<dd><p>A value specifying the position of the col names, defaults to 1. 1 means below the graph, 2 means above the graph. Use 3 to get tick marks below and above graph, but still need to specify xat.top and xaxis.lab.top to get values there</p></dd>

    <dt id="arg-shrink">shrink<a class="anchor" aria-label="anchor" href="#arg-shrink"></a></dt>
<dd><p>Allows rectangles to be scaled, defaults to 1</p></dd>

    <dt id="arg-row-colour">row.colour<a class="anchor" aria-label="anchor" href="#arg-row-colour"></a></dt>
<dd><p>Interior grid-line colour, defaults to “black”. Can be a vector</p></dd>

    <dt id="arg-col-colour">col.colour<a class="anchor" aria-label="anchor" href="#arg-col-colour"></a></dt>
<dd><p>Interior grid-line colour, defaults to “black”. Can be a vector</p></dd>

    <dt id="arg-row-lwd">row.lwd<a class="anchor" aria-label="anchor" href="#arg-row-lwd"></a></dt>
<dd><p>Interior grid-line width, defaults to 1. Setting to zero is equivalent to grid.row = FALSE and grid.col = FALSE.  Can be a vector.</p></dd>

    <dt id="arg-col-lwd">col.lwd<a class="anchor" aria-label="anchor" href="#arg-col-lwd"></a></dt>
<dd><p>Interior grid-line width, defaults to 1. Setting to zero is equivalent to grid.row = FALSE and grid.col = FALSE.  Can be a vector.</p></dd>

    <dt id="arg-grid-colour">grid.colour<a class="anchor" aria-label="anchor" href="#arg-grid-colour"></a></dt>
<dd><p>Interior grid-line colour, defaults to “black”. Can be a vector.  Applies to both rows and columns. DEPRECATED</p></dd>

    <dt id="arg-grid-lwd">grid.lwd<a class="anchor" aria-label="anchor" href="#arg-grid-lwd"></a></dt>
<dd><p>Interior grid-line width, defaults to 1. Setting to zero is equivalent to grid.row = FALSE and grid.col = FALSE.  Applies to both rows and columns. DEPRECATED</p></dd>

    <dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>Figure width in size.units</p></dd>

    <dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>Figure height in size.units</p></dd>

    <dt id="arg-size-units">size.units<a class="anchor" aria-label="anchor" href="#arg-size-units"></a></dt>
<dd><p>Units of size for the figure</p></dd>

    <dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>Figure resolution in dpi</p></dd>

    <dt id="arg-enable-warnings">enable.warnings<a class="anchor" aria-label="anchor" href="#arg-enable-warnings"></a></dt>
<dd><p>Print warnings if set to TRUE, defaults to FALSE</p></dd>

    <dt id="arg-xaxis-covariates">xaxis.covariates<a class="anchor" aria-label="anchor" href="#arg-xaxis-covariates"></a></dt>
<dd><p>Any column-wise covariate annotate to add to the plot, as a fully formed list</p></dd>

    <dt id="arg-xaxis-covariates-y">xaxis.covariates.y<a class="anchor" aria-label="anchor" href="#arg-xaxis-covariates-y"></a></dt>
<dd><p>The y coordinate of the location of the x axis covariates</p></dd>

    <dt id="arg-yaxis-covariates">yaxis.covariates<a class="anchor" aria-label="anchor" href="#arg-yaxis-covariates"></a></dt>
<dd><p>Any row-wise covariate annotate to add to the plot, as a fully formed list</p></dd>

    <dt id="arg-yaxis-covariates-x">yaxis.covariates.x<a class="anchor" aria-label="anchor" href="#arg-yaxis-covariates-x"></a></dt>
<dd><p>The x coordinate of the lcoation of the y axis covariates</p></dd>

    <dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>Short description of image/plot; default NULL.</p></dd>

    <dt id="arg-xaxis-fontface">xaxis.fontface<a class="anchor" aria-label="anchor" href="#arg-xaxis-fontface"></a></dt>
<dd><p>Fontface for the x-axis scales</p></dd>

    <dt id="arg-yaxis-fontface">yaxis.fontface<a class="anchor" aria-label="anchor" href="#arg-yaxis-fontface"></a></dt>
<dd><p>Fontface for the y-axis scales</p></dd>

    <dt id="arg-symbols">symbols<a class="anchor" aria-label="anchor" href="#arg-symbols"></a></dt>
<dd><p>Extra symbols to be added (borders, squares and circles)</p></dd>

    <dt id="arg-same-as-matrix">same.as.matrix<a class="anchor" aria-label="anchor" href="#arg-same-as-matrix"></a></dt>
<dd><p>Prevents the flipping of the matrix that the function normally does</p></dd>

    <dt id="arg-input-colours">input.colours<a class="anchor" aria-label="anchor" href="#arg-input-colours"></a></dt>
<dd><p>boolean expressing whether or not the matrix was specified using colours or integer values. Defaults to FALSE</p></dd>

    <dt id="arg-axis-xlab-padding">axis.xlab.padding<a class="anchor" aria-label="anchor" href="#arg-axis-xlab-padding"></a></dt>
<dd><p>Padding between axis of plot and x label</p></dd>

    <dt id="arg-stratified-clusters-rows">stratified.clusters.rows<a class="anchor" aria-label="anchor" href="#arg-stratified-clusters-rows"></a></dt>
<dd><p>the row locations of the rows to be combined into a strata</p></dd>

    <dt id="arg-stratified-clusters-cols">stratified.clusters.cols<a class="anchor" aria-label="anchor" href="#arg-stratified-clusters-cols"></a></dt>
<dd><p>the column locations of the columns to be combined into a strata</p></dd>

    <dt id="arg-inside-legend">inside.legend<a class="anchor" aria-label="anchor" href="#arg-inside-legend"></a></dt>
<dd><p>legend specification for the inside legend/key of the heatmap</p></dd>

    <dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>defaults to “BoutrosLab”, also accepts “Nature”, which changes parameters according to Nature formatting requirements</p></dd>

    <dt id="arg-preload-default">preload.default<a class="anchor" aria-label="anchor" href="#arg-preload-default"></a></dt>
<dd><p>ability to set multiple sets of diffrent defaults depending on publication needs</p></dd>

    <dt id="arg-use-legacy-settings">use.legacy.settings<a class="anchor" aria-label="anchor" href="#arg-use-legacy-settings"></a></dt>
<dd><p>boolean to set wheter or not to use legacy mode settings (font)</p></dd>


 </dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>filename</code> is <code>NULL</code> then returns the trellis object, otherwise creates a plot and returns a 0/1 success code.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul C. Boutros</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="covariates.grob.html">covariates.grob</a></code>, <code><a href="create.dendrogram.html">create.dendrogram</a></code>, <code><a href="legend.grob.html">legend.grob</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>If this function is called without capturing the return value, or specifying a filename, it may crash while trying to draw the heatmap. In particular, if a script that uses such a call of create heatmap is called by reading the script in from the command line, it will fail badly, with an error message about unavailable fonts:<br></p><div class="sourceCode"><pre><code>
    Error in grid.Call.graphics("L_text", as.graphicsAnnot(x$label), x$x,  )
        Invalid font type
    Calls: print ... drawDetails.text -&gt; grid.Call.graphics -&gt; .Call.graphics
    </code></pre></div>

<p>Note that we would very much like to be able to pass <code>xaxis.cex</code> and <code>yaxis.cex</code> as vectors of the same length as the actual data-table. However lattice does not support that, because it currently expects them as a two-element vectors to specify left/right or top/bottom axes separately. I've raised a bug report on requesting an enhancement, but this would require an API change so... not sure if it will happen. Here's the bug-report:
https://r-forge.r-project.org/tracker/index.php?func=detail&amp;aid=1702&amp;group_id=638&amp;atid=2567</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">simple.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simple.1D.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_1D_Inside_Legend'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.1D.data</span>,</span></span>
<span class="r-in"><span>    clustering.method<span class="op">=</span><span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    inside.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">draw.key</span>,</span></span>
<span class="r-in"><span>        args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                    lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'test'</span>,<span class="st">'test'</span>,<span class="st">'test'</span>,<span class="st">'test'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                    fontface <span class="op">=</span> <span class="st">'bold'</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span>,</span></span>
<span class="r-in"><span>                padding.text <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                background <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    alpha.background <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        x <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>        y <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Simple'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Simple'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simple.data.col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'blue'</span>,<span class="st">'green'</span>,<span class="st">'red'</span>,<span class="st">'yellow'</span>,<span class="st">'blue'</span>,<span class="st">'red'</span>,<span class="st">'black'</span>,<span class="st">'white'</span>,<span class="st">'purple'</span>,<span class="st">'grey'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'red'</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'yellow'</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'green'</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'purple'</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Input Colours Provided</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Simple_Using_Colours'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.data.col</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    input.colours <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single Input Colour Provided</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Simple_Using_Single_Colour'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.data.col</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">simple.data.col</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    input.colours <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal Input</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Minimal_Input'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Minimal input'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Axes and labels</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Axes_Labels'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Axes &amp; labels'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing axes</span></span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Turning on default row and column labels</span></span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting font sizes</span></span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing colourkey</span></span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Custom Axes</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Custom_Axes'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Customized axes'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Specify where to place tick marks</span></span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Specify label colours (note: this is based on the pre-clustering order)</span></span></span>
<span class="r-in"><span>    xaxis.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'black'</span>, <span class="st">'red'</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'black'</span>,<span class="fl">6</span><span class="op">)</span>, <span class="st">'red'</span>,<span class="st">'black'</span>, <span class="st">'black'</span>,<span class="st">'red'</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'black'</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Two-sided Colour Scheme</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Colour_Scheme_1'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colour scheme'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing the colours</span></span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'firebrick'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Three-sided Colour Scheme</span></span></span>
<span class="r-in"><span><span class="co"># Note: when using a three-sided colour scheme, it is advised to have two-sided data</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Colour_Scheme_2'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colour scheme'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing the colours</span></span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>,<span class="st">'white'</span>,<span class="st">'turquoise'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Scale the data to center around the mean</span></span></span>
<span class="r-in"><span>    scale.data <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colour Alpha</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Colour_Alpha'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Colours alpha'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the alpha value of the colours</span></span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clustering</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_No_Clustering'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'No clustering'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Turning clustering off</span></span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clustering</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Clustering_Methods'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Clustering methods'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Clustering method defaults to 'diana', but can be set to other options</span></span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'complete'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Also setting the distance measures</span></span></span>
<span class="r-in"><span>    rows.distance.method <span class="op">=</span> <span class="st">'euclidean'</span>,</span></span>
<span class="r-in"><span>    cols.distance.method <span class="op">=</span> <span class="st">'manhattan'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratified Clustering</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Stratified_Clustering'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Stratified clustering'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Stratifying the clustering by rows</span></span></span>
<span class="r-in"><span>    stratified.clusters.rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adding line to show highlight the division between the two strata</span></span></span>
<span class="r-in"><span>    grid.row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    row.lines <span class="op">=</span> <span class="fl">10.5</span>,</span></span>
<span class="r-in"><span>    row.lwd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Dendrogram provided</span></span></span>
<span class="r-in"><span><span class="va">col.dendrogram</span> <span class="op">&lt;-</span> <span class="fu">BoutrosLab.plotting.general</span><span class="fu">::</span><span class="fu"><a href="create.dendrogram.html">create.dendrogram</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    cluster.dimension <span class="op">=</span> <span class="st">'col'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">row.dendrogram</span> <span class="op">&lt;-</span> <span class="fu">BoutrosLab.plotting.general</span><span class="fu">::</span><span class="fu"><a href="create.dendrogram.html">create.dendrogram</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    cluster.dimension <span class="op">=</span> <span class="st">'row'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Dendrogram_Provided'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Dendrogram provided'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># note: row/column dendrograms are switched because the function inverts rows and columns</span></span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    row.dendrogram <span class="op">=</span> <span class="va">col.dendrogram</span>,</span></span>
<span class="r-in"><span>    col.dendrogram <span class="op">=</span> <span class="va">row.dendrogram</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting the size of the dendrogram</span></span></span>
<span class="r-in"><span>    right.dendrogram.size <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    top.dendrogram.size <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Covariates and Legends</span></span></span>
<span class="r-in"><span><span class="co"># Note: covariates can also be added using the create.multiplot function</span></span></span>
<span class="r-in"><span><span class="co"># set the colour schemes for the covariates</span></span></span>
<span class="r-in"><span><span class="va">sex.colours</span> <span class="op">&lt;-</span> <span class="va">patient</span><span class="op">$</span><span class="va">sex</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colours</span><span class="op">[</span><span class="va">sex.colours</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'dodgerblue'</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colours</span><span class="op">[</span><span class="va">sex.colours</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'pink'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">stage.colours</span> <span class="op">&lt;-</span> <span class="va">patient</span><span class="op">$</span><span class="va">stage</span>;</span></span>
<span class="r-in"><span><span class="va">stage.colours</span><span class="op">[</span><span class="va">stage.colours</span> <span class="op">==</span> <span class="st">'I'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'plum1'</span>;</span></span>
<span class="r-in"><span><span class="va">stage.colours</span><span class="op">[</span><span class="va">stage.colours</span> <span class="op">==</span> <span class="st">'II'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid1'</span>;</span></span>
<span class="r-in"><span><span class="va">stage.colours</span><span class="op">[</span><span class="va">stage.colours</span> <span class="op">==</span> <span class="st">'III'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid3'</span>;</span></span>
<span class="r-in"><span><span class="va">stage.colours</span><span class="op">[</span><span class="va">stage.colours</span> <span class="op">==</span> <span class="st">'IV'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid4'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create an object to draw the covariates from</span></span></span>
<span class="r-in"><span><span class="va">sample.covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">sex.colours</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'black'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">stage.colours</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a legend for the covariates</span></span></span>
<span class="r-in"><span><span class="va">sample.cov.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Sex'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'plum1'</span>, <span class="st">'orchid1'</span>,<span class="st">'orchid3'</span>, <span class="st">'orchid4'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I'</span>,<span class="st">'II'</span>, <span class="st">'III'</span>, <span class="st">'IV'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Stage'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Covariates_Simple'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Covariates'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># adding covariates and corresponding legend</span></span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="va">sample.covariate</span>,</span></span>
<span class="r-in"><span>    covariate.legend <span class="op">=</span> <span class="va">sample.cov.legend</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Top covariate and legend customization</span></span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span> <span class="op">&lt;-</span> <span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span>;</span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span><span class="op">[</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span><span class="op">[</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">chr.cov.colours</span><span class="op">[</span><span class="va">microarray</span><span class="op">$</span><span class="va">Chr</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chr.covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">chr.cov.colours</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># join covariate legends</span></span></span>
<span class="r-in"><span><span class="va">combo.cov.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">3</span>, palette.type <span class="op">=</span> <span class="st">'chromosomes'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">'3'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Chromosome'</span>,</span></span>
<span class="r-in"><span>        border <span class="op">=</span> <span class="st">'white'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Sex'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'plum1'</span>, <span class="st">'orchid1'</span>,<span class="st">'orchid3'</span>, <span class="st">'orchid4'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I'</span>,<span class="st">'II'</span>, <span class="st">'III'</span>, <span class="st">'IV'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">'Stage'</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Covariate_Legend_Custom'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Custom covariates &amp; legend'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># side covariate</span></span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="va">sample.covariate</span>,</span></span>
<span class="r-in"><span>    <span class="co"># top covariate and covariate border specification</span></span></span>
<span class="r-in"><span>    covariates.top <span class="op">=</span> <span class="va">chr.covariate</span>,</span></span>
<span class="r-in"><span>    covariate.legend <span class="op">=</span> <span class="va">combo.cov.legend</span>,</span></span>
<span class="r-in"><span>    <span class="co"># making outline of border a matching green</span></span></span>
<span class="r-in"><span>    covariates.top.grid.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">'lightblue'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># making certain column divisions a different colour</span></span></span>
<span class="r-in"><span>    covariates.top.col.lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    covariates.top.grid.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">'blue'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># legend customization</span></span></span>
<span class="r-in"><span>    legend.side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'right'</span>,<span class="st">'left'</span>,<span class="st">'top'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend.title.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    legend.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    legend.title.just <span class="op">=</span> <span class="st">'left'</span>,</span></span>
<span class="r-in"><span>    legend.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom gridlines</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Gridlines'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Gridlines'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># colouring gridlines</span></span></span>
<span class="r-in"><span>    grid.row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    grid.col <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    row.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    col.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    row.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    col.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Label cells</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Labelled_Cells'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Labelled cells'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    grid.row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    grid.col <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    row.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    col.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    row.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    col.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># conditionally labelling cells</span></span></span>
<span class="r-in"><span>    <span class="co"># flipping rows and columns because the heatmap function does so</span></span></span>
<span class="r-in"><span>    row.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    col.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    cell.text <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">[</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    text.col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    text.cex <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="co"># Label cells</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Labelled_Cells_NPC'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Labelled cells'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    grid.row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    grid.col <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    row.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    col.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    row.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    col.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    text.use.grid.coordinates <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    <span class="co"># conditionally labelling cells</span></span></span>
<span class="r-in"><span>    <span class="co"># flipping rows and columns because the heatmap function does so</span></span></span>
<span class="r-in"><span>    cell.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text1"</span>,<span class="st">"text2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    text.col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    text.cex <span class="op">=</span> <span class="fl">0.65</span>,</span></span>
<span class="r-in"><span>    text.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method 1 of adding symbols (very similar to how text is added)</span></span></span>
<span class="r-in"><span><span class="va">points</span> <span class="op">&lt;-</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">[</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">size.from</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">points</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">size.to</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">point.size</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">points</span> <span class="op">-</span> <span class="va">size.from</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">size.from</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">size.to</span><span class="op">)</span> <span class="op">+</span> <span class="va">size.to</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="va">point.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">)</span>, max <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Symbols_1'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Symbols'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># conditionally adding points to cells</span></span></span>
<span class="r-in"><span>    <span class="co"># flipping rows and columns because the heatmap function does so</span></span></span>
<span class="r-in"><span>    row.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    col.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    cell.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"\u25CF"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    text.col <span class="op">=</span> <span class="va">point.colour</span>,</span></span>
<span class="r-in"><span>    text.cex <span class="op">=</span> <span class="va">point.size</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method 2 of Adding Symbols</span></span></span>
<span class="r-in"><span><span class="co"># Create matrices to describe the symbols</span></span></span>
<span class="r-in"><span><span class="va">circle.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">circle.colour.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="st">'pink'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">circle.size.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fl">20</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">border.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">border.colour.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="st">'black'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">border.size.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">square.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">square.colour.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="st">'pink'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">square.size.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># setting up the symbols</span></span></span>
<span class="r-in"><span><span class="va">symbol.locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    circles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="va">circle.matrix</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="va">circle.colour.matrix</span>,</span></span>
<span class="r-in"><span>            size <span class="op">=</span> <span class="va">circle.size.matrix</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    borders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="va">border.matrix</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="va">border.colour.matrix</span>,</span></span>
<span class="r-in"><span>            size <span class="op">=</span> <span class="va">border.size.matrix</span></span></span>
<span class="r-in"><span>            <span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="co"># creating a border encompassing a larger area</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            xright <span class="op">=</span> <span class="fl">12.10</span>,</span></span>
<span class="r-in"><span>            xleft <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>            ybottom <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            ytop <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>            size <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="st">'pink'</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    squares <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            x <span class="op">=</span> <span class="va">square.matrix</span>,</span></span>
<span class="r-in"><span>            col <span class="op">=</span> <span class="va">square.colour.matrix</span>,</span></span>
<span class="r-in"><span>            size <span class="op">=</span> <span class="va">square.size.matrix</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set which items in the matrix will be shown</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># symbol.locations$borders[[1]]$x &lt;- FALSE;</span></span></span>
<span class="r-in"><span><span class="co"># symbol.locations$squares[[1]]$x &lt;- FALSE;</span></span></span>
<span class="r-in"><span><span class="va">symbol.locations</span><span class="op">$</span><span class="va">circles</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">11</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Symbols_2'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Symbols'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># adding symbols</span></span></span>
<span class="r-in"><span>    symbols <span class="op">=</span> <span class="va">symbol.locations</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Rotate matrix</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Rotated_Matrix'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Rotated matrix'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Also flip labels</span></span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="st">'automatic'</span>,</span></span>
<span class="r-in"><span>    grid.row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    grid.col <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    row.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    col.colour <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    row.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    col.lwd <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    <span class="co"># stop heatmap function from rotating matrix</span></span></span>
<span class="r-in"><span>    same.as.matrix <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example of using discrete data</span></span></span>
<span class="r-in"><span><span class="va">discrete.data</span> <span class="op">&lt;-</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="co"># Looking for values greater than 10</span></span></span>
<span class="r-in"><span><span class="va">discrete.data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">discrete.data</span> <span class="op">&lt;</span> <span class="fl">10</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>;</span></span>
<span class="r-in"><span><span class="va">discrete.data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">discrete.data</span> <span class="op">&gt;</span> <span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sex.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colour</span><span class="op">[</span><span class="va">sex.colour</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'dodgerblue'</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colour</span><span class="op">[</span><span class="va">sex.colour</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'pink'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">stage</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'I'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'plum1'</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'II'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid1'</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'III'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid3'</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'IV'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid4'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">msi.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">msi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">msi.colour</span><span class="op">[</span><span class="va">msi.colour</span> <span class="op">==</span> <span class="st">'MSS'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'chartreuse4'</span></span></span>
<span class="r-in"><span><span class="va">msi.colour</span><span class="op">[</span><span class="va">msi.colour</span> <span class="op">==</span> <span class="st">'MSI-High'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'chartreuse2'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">discrete.covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">sex.colour</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">stage.colour</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">msi.colour</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">discrete.covariate.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'Sex'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'plum1'</span>, <span class="st">'orchid1'</span>, <span class="st">'orchid3'</span>, <span class="st">'orchid4'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I'</span>,<span class="st">'II'</span>, <span class="st">'III'</span>, <span class="st">'IV'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'Stage'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chartreuse4'</span>, <span class="st">'chartreuse2'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MSS'</span>,<span class="st">'MSI-High'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'MSI'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Discrete_Data'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">discrete.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Discrete data'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    same.as.matrix <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Customize plot</span></span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    total.colours <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'white'</span>,<span class="st">'black'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    fill.colour <span class="op">=</span> <span class="st">'grey95'</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Changing axes</span></span></span>
<span class="r-in"><span>    xat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.rot <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    xlab.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Covariates</span></span></span>
<span class="r-in"><span>    covariates.top <span class="op">=</span> <span class="va">discrete.covariate</span>,</span></span>
<span class="r-in"><span>    covariate.legend <span class="op">=</span> <span class="va">discrete.covariate.legend</span>,</span></span>
<span class="r-in"><span>    legend.side <span class="op">=</span> <span class="st">'right'</span>,</span></span>
<span class="r-in"><span>    legend.title.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    legend.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    legend.title.just <span class="op">=</span> <span class="st">'left'</span>,</span></span>
<span class="r-in"><span>    legend.between.row <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>    legend.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">'transparent'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend.border.padding <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    shrink <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>    covariates.top.grid.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">'black'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    scale.data <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    print.colour.key <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Correlation matrix</span></span></span>
<span class="r-in"><span><span class="co"># Example of how to visualize the relationship between (e.x.) different cellularity estimates</span></span></span>
<span class="r-in"><span><span class="co"># Generate a correlation matrix</span></span></span>
<span class="r-in"><span><span class="va">cor.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">'spearman'</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ensure that input data matrix is equal to what the heatmap clustering produces</span></span></span>
<span class="r-in"><span><span class="va">distance.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">cor.data</span><span class="op">)</span>, use <span class="op">=</span> <span class="st">"pairwise"</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">clustered.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">distance.matrix</span>, method <span class="op">=</span> <span class="st">"ward"</span><span class="op">)</span><span class="op">$</span><span class="va">order</span>;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The "ward" method has been renamed to "ward.D"; note new "ward.D2"</span>
<span class="r-in"><span><span class="va">cor.data</span> <span class="op">&lt;-</span> <span class="va">cor.data</span><span class="op">[</span><span class="va">clustered.order</span>, <span class="va">clustered.order</span><span class="op">]</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prepare labels</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor.data</span>, <span class="fl">2</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span>;</span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>, <span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span>;</span></span>
<span class="r-in"><span>    <span class="op">}</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Cellularity_Estimates'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">cor.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Correlation matrix'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    cell.text <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'ward'</span>,</span></span>
<span class="r-in"><span>    plot.dendrograms <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    rows.distance.method <span class="op">=</span> <span class="st">'correlation'</span>,</span></span>
<span class="r-in"><span>    cols.distance.method <span class="op">=</span> <span class="st">'correlation'</span>,</span></span>
<span class="r-in"><span>    cor.method <span class="op">=</span> <span class="st">'pearson'</span>,</span></span>
<span class="r-in"><span>    col.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">y</span> <span class="op">!=</span> <span class="st">'1'</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    row.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">y</span> <span class="op">!=</span> <span class="st">'1'</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    text.fontface <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    text.col <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>    text.cex <span class="op">=</span> <span class="fl">0.70</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'blue'</span>, <span class="st">'darkgrey'</span>, <span class="st">'brown'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.centering.value <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colour.alpha <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    grid.row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    grid.col <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The "ward" method has been renamed to "ward.D"; note new "ward.D2"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The "ward" method has been renamed to "ward.D"; note new "ward.D2"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Discrete sequential colours</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Discrete_Colours_Sequential'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Discrete colours'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting total colours plotted</span></span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Add one to account for a 'null' colour</span></span></span>
<span class="r-in"><span>    total.colours <span class="op">=</span> <span class="fl">11</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Discrete qualitative colours</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Discrete_Colours_Qualitative'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Discrete colours'</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Genes'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting total colours plotted</span></span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Add one to account for a 'null' colour</span></span></span>
<span class="r-in"><span>    total.colours <span class="op">=</span> <span class="fl">11</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Colour scheme may not be greyscale compatible.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nature style</span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_Nature_style'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">microarray</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Nature style'</span>,</span></span>
<span class="r-in"><span>    xaxis.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>    yaxis.lab <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    xaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    yaxis.fontface <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    colourkey.cex <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Adjusting total colours plotted</span></span></span>
<span class="r-in"><span>    colourkey.labels.at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    colourkey.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="co"># Add one to account for a 'null' colour</span></span></span>
<span class="r-in"><span>    total.colours <span class="op">=</span> <span class="fl">11</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="default.colours.html">default.colours</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># set style to Nature</span></span></span>
<span class="r-in"><span>    style <span class="op">=</span> <span class="st">'Nature'</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to italicize character variables</span></span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'italicized '</span>, <span class="fu">italic</span><span class="op">(</span><span class="st">'a'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># demonstrating how to create en-dashes</span></span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'en dashs: 1'</span>,<span class="st">'\u2013'</span>, <span class="st">'10'</span><span class="op">^</span><span class="st">'\u2013'</span>, <span class="st">''</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Colour scheme may not be greyscale compatible.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Setting resolution to 1200 dpi.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Nature also requires italicized single-letter variables and en-dashes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 			for ranges and negatives. See example in documentation for how to do this.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Avoid red-green colour schemes, create TIFF files, do not outline the figure or legend</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create heatmap with key like legend - used to show range of continuous variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First create legend with discrete colours</span></span></span>
<span class="r-in"><span><span class="va">sex.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colour</span><span class="op">[</span><span class="va">sex.colour</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'dodgerblue'</span>;</span></span>
<span class="r-in"><span><span class="va">sex.colour</span><span class="op">[</span><span class="va">sex.colour</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'pink'</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">stage</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'I'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'plum1'</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'II'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid1'</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'III'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid3'</span></span></span>
<span class="r-in"><span><span class="va">stage.colour</span><span class="op">[</span><span class="va">stage.colour</span> <span class="op">==</span> <span class="st">'IV'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'orchid4'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">msi.colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">msi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">msi.colour</span><span class="op">[</span><span class="va">msi.colour</span> <span class="op">==</span> <span class="st">'MSS'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'chartreuse4'</span></span></span>
<span class="r-in"><span><span class="va">msi.colour</span><span class="op">[</span><span class="va">msi.colour</span> <span class="op">==</span> <span class="st">'MSI-High'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'chartreuse2'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">discrete.covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">sex.colour</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">stage.colour</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="st">'transparent'</span>,</span></span>
<span class="r-in"><span>        fill <span class="op">=</span> <span class="va">msi.colour</span>,</span></span>
<span class="r-in"><span>        lwd <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">discrete.covariate.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dodgerblue'</span>, <span class="st">'pink'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'male'</span>,<span class="st">'female'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'Sex'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'plum1'</span>, <span class="st">'orchid1'</span>, <span class="st">'orchid3'</span>, <span class="st">'orchid4'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I'</span>,<span class="st">'II'</span>, <span class="st">'III'</span>, <span class="st">'IV'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'Stage'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chartreuse4'</span>, <span class="st">'chartreuse2'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MSS'</span>,<span class="st">'MSI-High'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'MSI'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey0'</span>, <span class="st">'grey100'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'want key like'</span>,<span class="st">'legend here'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'one'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  height<span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey0'</span>, <span class="st">'grey100'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'want key like'</span>,<span class="st">'legend here'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'two'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey0'</span>, <span class="st">'grey100'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">underline</span><span class="op">(</span><span class="st">'three'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>        width <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        tck <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        tck.number <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  angle <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>,</span></span>
<span class="r-in"><span>  just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>,<span class="st">"bottom"</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_ContinuousVariablesKey'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">patient</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    xlab.label <span class="op">=</span> <span class="st">'Samples'</span>,</span></span>
<span class="r-in"><span>    ylab.label <span class="op">=</span> <span class="st">'Scaled Data'</span>,</span></span>
<span class="r-in"><span>    xaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    yaxis.cex <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>    clustering.method <span class="op">=</span> <span class="st">'none'</span>,</span></span>
<span class="r-in"><span>    print.colour.key <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    scale<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    same.as.matrix <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    covariates.top <span class="op">=</span> <span class="va">discrete.covariate</span>,</span></span>
<span class="r-in"><span>    covariates.top.grid.row <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    covariate.legends <span class="op">=</span> <span class="va">discrete.covariate.legend</span>,</span></span>
<span class="r-in"><span>    legend.title.just <span class="op">=</span> <span class="st">'left'</span>,</span></span>
<span class="r-in"><span>    colour.scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gray0'</span>,<span class="st">'grey100'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    fill.colour <span class="op">=</span> <span class="st">'grey95'</span>,</span></span>
<span class="r-in"><span>    axis.xlab.padding <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create.heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Heatmap_borderRemoved'</span>, fileext <span class="op">=</span> <span class="st">'.tiff'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">simple.data</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">'Simple'</span>,</span></span>
<span class="r-in"><span>    description <span class="op">=</span> <span class="st">'Heatmap created using BoutrosLab.plotting.general'</span>,</span></span>
<span class="r-in"><span>    axes.lwd <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    resolution <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

